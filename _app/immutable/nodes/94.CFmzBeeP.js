import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{f as l,a as v,b as e,s as r,n as o,t as y}from"../chunks/BWp35gWV.js";import{T as tr}from"../chunks/CR7k0xtG.js";import{S as vr}from"../chunks/LIUKG8Hf.js";import{M as a}from"../chunks/BqyEoRxA.js";import{P as d}from"../chunks/B7flgP-x.js";import{T as rr}from"../chunks/y0AHHn4v.js";import{P as ar}from"../chunks/BBkyo9uE.js";import{P as q}from"../chunks/DPzc5wQr.js";import{S as lr}from"../chunks/CBbFRhrb.js";import{H as or}from"../chunks/DXKx2xvL.js";var mr=l(`Пусть <!>.
        Мы хотим решить задачу оптимизации`,1),sr=l("<!> <!>",1),xr=l(`Будем искать решение задачи итеративно.
        Пусть <!> &mdash; какое-то приближённое решение задачи,
        полученное нами на <!>-ом шаге.`,1),fr=l("Давайте будем двигаться в направлении наискорейшего спуска, которое задается антиградиентом <!>.",1),cr=l("<!> <!> <!>",1),ir=l("Как выбрать величину <!> нашего шага?",1),$r=l("Итак, для функции <!> мы хотим найти <!>.",1),pr=l(`Действуем мы итеративным методом, который на <!>-м шаге выдает нам решение <!>.
        При этом начинаем алгоритм мы с точки <!>, которая находится от оптимума на расстоянии не более <!>.`,1),kr=l("Все действия будут происходить в <!>-окрестности точки <!>.",1),hr=l("Функция <!> <!>-сильно выпукла",1),Pr=l("и её градиент <!> <!>-липшицев.",1),gr=l("<!> <!> <!> <!> <!> <!> <!> <!> <!>",1),ur=l("Мы хотим научиться оценивать скорость сходимости. Для этого целесообразно ввести расстояние до оптимума <!> на <!>-м шаге:",1),br=l("<!> <!> <!>",1),yr=l(`Поскольку <!> &mdash; точка минимума, градиент <!>.
        Из липшицевости градиента можно получить ограничение на градиент в любой точке <!>:`,1),Rr=l("<!> <!>",1),Lr=l(`<!> &mdash; точка минимума <!>,
        а значит <!> для любой точки <!>.
        Подставляем в предыдущую формулу`,1),Tr=l("<!> <!> <!> <!> <!> <!>",1),Sr=l(`Выберем константу <!>, называемую в машинном обучении learning rate.
        Формула расчета следующего положения будет такая`,1),qr=l("<!> <!> <!>",1),Hr=l(`Пусть <!> &mdash; выпуклая функция.
        Мы хотим найти <!>.`,1),Mr=l("Для этого мы используем алгоритм градиентного спуска с постоянной скоростью <!>",1),jr=l(`Если функция <!> <!>-сильно выпуклая
        и её градиент <!> <!>-липшицева, то`,1),wr=l(`и в самом плохом случае алгоритм сходится при <!>,
        а наибыстрейшая сходимость обеспечивается при <!>.`,1),zr=l("<!> <!> <!> <!> <!> <!>",1),Ar=l("Возьмем формулу шага, вычтем из левой и правой частей <!> и посчитаем квадрат нормы",1),Br=l("Воспользуемся тождеством <!>",1),Cr=l(`Максимальная скорость гарантируется минимальным множителем перед <!> в этой рекуррентной формуле.
        Для того, чтобы множитель был минимальным, learning rate должен быть равен <!>.`,1),Dr=l("<!> <!> <!> <!> <!> <!> <!> <!>",1),Er=l(`Можно сделать так, чтобы мы шагали на фиксированную длину <!>.
        Тогда формула расчета следующего положения будет такая`,1),Fr=l("<!> <!> <!> <!>",1),Gr=l(`Пусть <!> &mdash; выпуклая функция.
        Мы хотим найти <!>.`,1),Ir=l("Для этого мы используем алгоритм градиентного спуска с фиксированным шагом <!>",1),Jr=l("При этом <!> &mdash; сильно выпуклая функция с параметром <!>:",1),Kr=l("и градиент <!> липшицев с константой <!>:",1),Nr=l("<!> <!> <!> <!> <!> <!> <!>",1),Or=l(`Оценим расстояние до минимума.
        Пусть <!> &mdash; расстояние до минимума на шаге <!>.`,1),Qr=l("Вычитаем <!> и считаем квадрат нормы",1),Ur=l(`<!> &mdash; точка минимума <!>,
        а значит <!> для любой точки <!>.
        Подставляем в предыдущую формулу`,1),Vr=l("Используем липшицевость градиента, учитывая, что <!>",1),Wr=l("<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!>",1),Xr=l("<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!>",1);function ma(er){var w=Xr(),z=v(w);tr(z,{title:"Градиентный спуск"});var A=r(z,2);vr(A,{title:"Задача оптимизации",children:(h,R)=>{var t=sr(),f=v(t);d(f,{children:(k,p)=>{o();var i=mr(),s=r(v(i));a(s,{m:"f \\colon \\RR^n \\to \\RR"}),o(),e(k,i)}});var c=r(f,2);a(c,{display:!0,m:"\\min_{x \\in \\RR^n} f(x)"}),e(h,t)}});var B=r(A,2);q(B,{children:(h,R)=>{var t=cr(),f=v(t);d(f,{children:(p,i)=>{o();var s=xr(),_=r(v(s));a(_,{m:"x_k \\in \\RR"});var P=r(_,2);a(P,{m:"k"}),o(),e(p,s)}});var c=r(f,2);d(c,{children:(p,i)=>{o();var s=fr(),_=r(v(s));a(_,{m:"-\\nabla f"}),o(),e(p,s)}});var k=r(c,2);a(k,{display:!0,m:"x_{k+1} = x_k - \\alpha \\cdot \\nabla f (x_k)"}),e(h,t)}});var C=r(B,2);q(C,{children:(h,R)=>{d(h,{children:(t,f)=>{o();var c=ir(),k=r(v(c));a(k,{m:"\\alpha"}),o(),e(t,c)}})}});var D=r(C,2);lr(D,{children:(h,R)=>{o();var t=y("Скорость сходимости");e(h,t)}});var E=r(D,2);q(E,{children:(h,R)=>{var t=gr(),f=v(t);d(f,{children:(n,m)=>{o();var x=y("Для оценки скорости сходимости алгоритмов градиентного спуска придется использовать некоторые допущения.");e(n,x)}});var c=r(f,2);d(c,{children:(n,m)=>{o();var x=$r(),u=r(v(x));a(u,{m:"f \\colon \\RR^n \\to \\RR"});var L=r(u,2);a(L,{m:"x^* = \\argmin_{x \\in \\RR^n} f(x)"}),o(),e(n,x)}});var k=r(c,2);d(k,{children:(n,m)=>{o();var x=pr(),u=r(v(x));a(u,{m:"k"});var L=r(u,2);a(L,{m:"x_k"});var H=r(L,2);a(H,{m:"x_0"});var M=r(H,2);a(M,{m:"R"}),o(),e(n,x)}});var p=r(k,2);a(p,{display:!0,m:"\\|x_0 - x^*\\| \\le R"});var i=r(p,2);d(i,{children:(n,m)=>{o();var x=kr(),u=r(v(x));a(u,{m:"R"});var L=r(u,2);a(L,{m:"x^*"}),o(),e(n,x)}});var s=r(i,2);d(s,{children:(n,m)=>{o();var x=hr(),u=r(v(x));a(u,{m:"f"});var L=r(u,2);a(L,{m:"\\mu"}),o(),e(n,x)}});var _=r(s,2);a(_,{display:!0,m:"f(y) \\ge f(x) + \\nabla f (x) ^\\T \\cdot (y - x) + \\frac{\\mu}{2} \\cdot \\|y-x\\|^2"});var P=r(_,2);d(P,{children:(n,m)=>{o();var x=Pr(),u=r(v(x));a(u,{m:"\\nabla f"});var L=r(u,2);a(L,{m:"L"}),o(),e(n,x)}});var $=r(P,2);a($,{display:!0,m:"\\| \\nabla f (x) - \\nabla f (y) \\| \\le L \\cdot \\|x-y\\|"}),e(h,t)}});var F=r(E,2);q(F,{children:(h,R)=>{var t=br(),f=v(t);d(f,{children:(p,i)=>{o();var s=ur(),_=r(v(s));a(_,{m:"d_k"});var P=r(_,2);a(P,{m:"k"}),o(),e(p,s)}});var c=r(f,2);a(c,{display:!0,m:"d_k = \\|x_k - x^*\\|"});var k=r(c,2);d(k,{children:(p,i)=>{o();var s=y("Давайте сразу получим все важные соотношения, которые нам будут нужны для получения оценок.");e(p,s)}}),e(h,t)}});var G=r(F,2);q(G,{children:(h,R)=>{var t=Rr(),f=v(t);d(f,{children:(k,p)=>{o();var i=yr(),s=r(v(i));a(s,{m:"x^*"});var _=r(s,2);a(_,{m:"\\nabla f (x^*) = \\0"});var P=r(_,2);a(P,{m:"x_k"}),o(),e(k,i)}});var c=r(f,2);a(c,{display:!0,m:"\\| \\nabla f (x_k) \\| = \\| \\nabla f (x_k) - \\nabla f (x^*) \\| \\le L \\cdot \\| x_k - x^* \\| = L \\cdot d_k"}),e(h,t)}});var I=r(G,2);q(I,{children:(h,R)=>{var t=Tr(),f=v(t);d(f,{children:(_,P)=>{o();var $=y("Используем свойство сильной выпуклости функции");e(_,$)}});var c=r(f,2);a(c,{display:!0,m:"f(x^*) \\ge f(x_k) + \\nabla f (x_k) ^\\T \\cdot (x^* - x_k) + \\frac{\\mu}{2} \\cdot \\|x^*-x_k\\|^2"});var k=r(c,2);d(k,{children:(_,P)=>{var $=Lr(),n=v($);a(n,{m:"x^*"});var m=r(n,2);a(m,{m:"f"});var x=r(m,2);a(x,{m:"f(x^*) - f(x_k) \\le 0"});var u=r(x,2);a(u,{m:"x_k"}),o(),e(_,$)}});var p=r(k,2);a(p,{display:!0,m:"0 \\ge \\nabla f (x_k) ^\\T \\cdot (x^* - x_k) + \\frac{\\mu}{2} \\cdot \\|x^*-x_k\\|^2"});var i=r(p,2);d(i,{children:(_,P)=>{o();var $=y("Из этого неравенства получаем, что");e(_,$)}});var s=r(i,2);a(s,{display:!0,m:"\\nabla f (x_k) ^\\T \\cdot (x_k - x^*) \\ge \\frac{\\mu}{2} \\cdot \\|x_k - x^*\\|^2"}),e(h,t)}});var J=r(I,2);or(J,{children:(h,R)=>{o();var t=y("Постоянная скорость");e(h,t)}});var K=r(J,2);q(K,{children:(h,R)=>{var t=qr(),f=v(t);d(f,{children:(p,i)=>{o();var s=y(`Чем больше градиент, тем «круче» функция.
        Давайте, руководствуясь этими соображениями, сделаем скорость спуска постоянной.`);e(p,s)}});var c=r(f,2);d(c,{children:(p,i)=>{o();var s=Sr(),_=r(v(s));a(_,{m:"\\eta"}),o(),e(p,s)}});var k=r(c,2);a(k,{display:!0,m:"x_{k+1} = x_k - \\eta \\cdot \\nabla f (x_k)"}),e(h,t)}});var N=r(K,2);rr(N,{title:"Скорость сходимости градиентного спуска с постоянной скоростью",children:(h,R)=>{var t=zr(),f=v(t);d(f,{children:(_,P)=>{o();var $=Hr(),n=r(v($));a(n,{m:"f \\colon \\RR^n \\to \\RR"});var m=r(n,2);a(m,{m:"x^* = \\argmin_{x \\in \\RR^n} f(x)"}),o(),e(_,$)}});var c=r(f,2);d(c,{children:(_,P)=>{o();var $=Mr(),n=r(v($));a(n,{m:"\\eta"}),e(_,$)}});var k=r(c,2);a(k,{display:!0,m:"x_{k+1} = x_k - \\eta \\cdot \\nabla f (x_k)"});var p=r(k,2);d(p,{children:(_,P)=>{o();var $=jr(),n=r(v($));a(n,{m:"f"});var m=r(n,2);a(m,{m:"\\mu"});var x=r(m,2);a(x,{m:"\\nabla f"});var u=r(x,2);a(u,{m:"L"}),o(),e(_,$)}});var i=r(p,2);a(i,{display:!0,m:"d_{k+1} \\le \\sqrt{1 + \\eta^2 L^2 - \\eta \\mu} \\cdot d_k"});var s=r(i,2);d(s,{children:(_,P)=>{o();var $=wr(),n=r(v($));a(n,{m:"\\eta \\lt \\frac{\\mu}{L^2}"});var m=r(n,2);a(m,{m:"\\eta = \\frac{\\mu}{2L^2}"}),o(),e(_,$)}}),e(h,t)}});var O=r(N,2);ar(O,{children:(h,R)=>{var t=Dr(),f=v(t);d(f,{children:($,n)=>{o();var m=Ar(),x=r(v(m));a(x,{m:"x^*"}),o(),e($,m)}});var c=r(f,2);a(c,{display:!0,m:"d_{k+1}^2 = \\|x_{k+1} - x^*\\|^2 = \\big\\| (x_k - x^*) - \\eta \\cdot \\nabla f (x_k) \\big\\|^2"});var k=r(c,2);d(k,{children:($,n)=>{o();var m=Br(),x=r(v(m));a(x,{m:"\\|a-b\\|^2 = \\|a\\|^2 - 2 \\cdot a ^\\T \\cdot b + \\|b\\|^2"}),e($,m)}});var p=r(k,2);a(p,{display:!0,m:"d_{k+1}^2 = \\|x_k - x^*\\|^2 - 2 \\eta \\cdot \\nabla f (x_k) ^\\T \\cdot (x_k - x^*) + \\eta^2 \\cdot \\| \\nabla f (x_k) \\|^2"});var i=r(p,2);d(i,{children:($,n)=>{o();var m=y("Применим выведенные в разделе ... оценки и получим формулу");e($,m)}});var s=r(i,2);a(s,{display:!0,m:"d_{k+1}^2 \\le d_k^2 - 2 \\eta \\cdot \\frac{\\mu}{2} \\cdot d_k^2 + \\eta^2 L^2 \\cdot d_k^2"});var _=r(s,2);a(_,{display:!0,m:"d_{k+1} \\le \\sqrt{1 - \\eta \\mu + \\eta^2 L^2} \\cdot d_k"});var P=r(_,2);d(P,{children:($,n)=>{o();var m=Cr(),x=r(v(m));a(x,{m:"d_k"});var u=r(x,2);a(u,{m:"\\frac{\\mu}{2L^2}"}),o(),e($,m)}}),e(h,t)}});var Q=r(O,2);or(Q,{children:(h,R)=>{o();var t=y("Фиксированный шаг");e(h,t)}});var U=r(Q,2);q(U,{children:(h,R)=>{var t=Fr(),f=v(t);d(f,{children:(i,s)=>{o();var _=Er(),P=r(v(_));a(P,{m:"l"}),o(),e(i,_)}});var c=r(f,2);a(c,{display:!0,m:"x_{k+1} = x_k - l \\cdot \\frac {\\nabla f (x_k)}{\\|\\nabla f (x_k)\\|}"});var k=r(c,2);d(k,{children:(i,s)=>{o();var _=y(`Шаг постоянный, поэтому этот вариант алгоритма устойчив к резким изменениям градиента.
        Если функция пологая (градиент очень маленький), мы будем довольно долго подбираться к оптимуму.`);e(i,_)}});var p=r(k,2);d(p,{children:(i,s)=>{o();var _=y("Главный минус фиксированного шага — маленькая точность. Давайте найдем предельную точность алгоритма.");e(i,_)}}),e(h,t)}});var V=r(U,2);rr(V,{title:"Предельная точность градиентного спуска с фиксированным шагом",children:(h,R)=>{var t=Nr(),f=v(t);d(f,{children:(P,$)=>{o();var n=Gr(),m=r(v(n));a(m,{m:"f \\colon \\RR^n \\to \\RR"});var x=r(m,2);a(x,{m:"x^* = \\argmin_{x \\in \\RR^n} f(x)"}),o(),e(P,n)}});var c=r(f,2);d(c,{children:(P,$)=>{o();var n=Ir(),m=r(v(n));a(m,{m:"l"}),e(P,n)}});var k=r(c,2);a(k,{display:!0,m:"x_{k+1} = x_k - l \\cdot \\frac {\\nabla f (x_k)}{\\|\\nabla f (x_k)\\|}"});var p=r(k,2);d(p,{children:(P,$)=>{o();var n=Jr(),m=r(v(n));a(m,{m:"f"});var x=r(m,2);a(x,{m:"\\mu"}),o(),e(P,n)}});var i=r(p,2);a(i,{display:!0,m:"f(y) \\ge f(x) + \\nabla f (x) ^\\T \\cdot (y - x) + \\frac{\\mu}{2} \\cdot \\|y-x\\|^2"});var s=r(i,2);d(s,{children:(P,$)=>{o();var n=Kr(),m=r(v(n));a(m,{m:"\\nabla f"});var x=r(m,2);a(x,{m:"L"}),o(),e(P,n)}});var _=r(s,2);a(_,{display:!0,m:"\\| \\nabla f (x) - \\nabla f (y) \\| \\le L \\cdot \\|x-y\\|"}),e(h,t)}});var _r=r(V,2);ar(_r,{children:(h,R)=>{var t=Wr(),f=v(t);d(f,{children:(b,T)=>{o();var g=Or(),S=r(v(g));a(S,{m:"d_k = \\|x_k - x^*\\|"});var j=r(S,2);a(j,{m:"k"}),o(),e(b,g)}});var c=r(f,2);d(c,{children:(b,T)=>{o();var g=y("Алгоритм делает шаг согласно формуле");e(b,g)}});var k=r(c,2);a(k,{display:!0,m:"x_{k+1} = x_k - l \\cdot \\frac {\\nabla f (x_k)}{\\|\\nabla f (x_k)\\|}"});var p=r(k,2);d(p,{children:(b,T)=>{o();var g=Qr(),S=r(v(g));a(S,{m:"x^*"}),o(),e(b,g)}});var i=r(p,2);a(i,{display:!0,m:"\\| x_{k+1} - x^* \\|^2 = \\left\\| (x_k - x^*) - l \\cdot \\frac {\\nabla f (x_k)}{\\|\\nabla f (x_k)\\|} \\right\\|^2"});var s=r(i,2);d(s,{children:(b,T)=>{o();var g=y("Раскрыв квадрат нормы и переписываем в терминах расстояний до минимума. Получим формулу");e(b,g)}});var _=r(s,2);a(_,{display:!0,m:"d_{k+1}^2 = d_k^2 - 2 \\cdot l \\cdot \\frac {\\nabla f (x_k) ^\\T \\cdot (x_k - x^*)}{\\|\\nabla f (x_k)\\|} + l^2"});var P=r(_,2);d(P,{children:(b,T)=>{o();var g=y("Нам нужно как-то оценить страшный коэффициент с градиентом.");e(b,g)}});var $=r(P,2);d($,{children:(b,T)=>{o();var g=y("Используем свойство сильной выпуклости функции");e(b,g)}});var n=r($,2);a(n,{display:!0,m:"f(x^*) \\ge f(x_k) + \\nabla f (x_k) ^\\T \\cdot (x^* - x_k) + \\frac{\\mu}{2} \\cdot \\|x^*-x_k\\|^2"});var m=r(n,2);d(m,{children:(b,T)=>{var g=Ur(),S=v(g);a(S,{m:"x^*"});var j=r(S,2);a(j,{m:"f"});var Z=r(j,2);a(Z,{m:"f(x^*) - f(x_k) \\le 0"});var dr=r(Z,2);a(dr,{m:"x_k"}),o(),e(b,g)}});var x=r(m,2);a(x,{display:!0,m:"0 \\ge \\nabla f (x_k) ^\\T \\cdot (x^* - x_k) + \\frac{\\mu}{2} \\cdot \\|x^*-x_k\\|^2"});var u=r(x,2);d(u,{children:(b,T)=>{o();var g=y("Из этого неравенства получаем, что");e(b,g)}});var L=r(u,2);a(L,{display:!0,m:"\\nabla f (x_k) ^\\T \\cdot (x_k - x^*) \\ge \\frac{\\mu}{2} \\cdot \\|x_k - x^*\\|^2"});var H=r(L,2);d(H,{children:(b,T)=>{o();var g=Vr(),S=r(v(g));a(S,{m:"\\nabla f (x^*) = \\0"}),e(b,g)}});var M=r(H,2);a(M,{display:!0,m:"\\| \\nabla f (x_k) \\| = \\| \\nabla f(x_k) - \\nabla f (x^*) \\| \\le L \\cdot \\| x_k - x^* \\| = L \\cdot d_k"});var W=r(M,2);d(W,{children:(b,T)=>{o();var g=y("Применим эти два неравенства для оценки страшного коэффициента");e(b,g)}});var X=r(W,2);a(X,{display:!0,m:"\\frac {\\nabla f (x_k) ^\\T \\cdot (x_k - x^*)}{\\|\\nabla f (x_k)\\|} \\ge \\frac{\\frac{\\mu}{2} \\cdot d_k^2}{L \\cdot d_k} = \\frac{\\mu}{2L} \\cdot d_k"});var Y=r(X,2);d(Y,{children:(b,T)=>{o();var g=y("В итоге получаем формулу для рекуррентного вычисления расстояния до оптимума");e(b,g)}});var nr=r(Y,2);a(nr,{display:!0,m:"d_{k+1}^2 \\le d_k^2 - \\frac{\\mu l}{L} \\cdot d_k + l^2"}),e(h,t)}}),e(er,w)}export{ma as component};
