import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{f as l,a as t,b as n,s as r,n as _,t as P}from"../chunks/BWp35gWV.js";import{T as tr}from"../chunks/CR7k0xtG.js";import{P as H}from"../chunks/DPzc5wQr.js";import{P as i}from"../chunks/B7flgP-x.js";/* empty css                *//* empty css                */import{S as nr}from"../chunks/CBbFRhrb.js";import{C as sr}from"../chunks/BvAJckrt.js";import{C as dr}from"../chunks/BmgYHZay.js";import{H as z}from"../chunks/DXKx2xvL.js";import{M as o}from"../chunks/BqyEoRxA.js";/* empty css                *//* empty css                */import{P as ir}from"../chunks/BBkyo9uE.js";import{L as vr}from"../chunks/DDpIWRRY.js";var cr=l("<b>Гармонические числа</b> (harmonic numbers) &mdash; числа",1),fr=l("<!> <!> <!>",1),$r=l(`Важное свойство гармонических чисел, основа их асимптотического анализа &mdash; <!>.
    Доказать это можно, рассмотреть если ограничить <!> с двух сторон интегралами`,1),ur=l("Делим все части неравенства на <!> и переходим к пределу.",1),pr=l("Есть более общая формула, использующая константу Эйлера-Маскерони <!>",1),kr=l("<!> <!> <!> <!> <!> <!>",1),gr=l(`Количество итераций вложенного цикла, которое совпадает с количеством выполнения куска кода <!>,
    равно`,1),jr=l("<!> <!>",1),hr=l("Вычислим сумму гармонических чисел <!>, поменяв порядок суммирования",1),Pr=l("<!> <!>",1),Hr=l("Давайте теперь вычислим общую сумму <!>.",1),br=l("<!> <!>",1),xr=l(`<b>Способ вычисления.</b> Поскольку сама формула суммы очень большая и сложная, я просто покажу, как её можно считать,
    а потом приведу некоторые частные значения.`,1),yr=l(`Рассмотрим исходную сумму <!>, распишем гармоническое число
    и поменяем порядок суммирования`,1),Br=l("разделе &laquo;Суммы <!>-х степеней&raquo; статьи &laquo;Числа Бернулли&raquo;",1),qr=l(`Внутренняя сумма &mdash; это сумма <!>-х степеней чисел от <!> до <!>.
    Эту сумму можно вычислить как разность сумм Фаульхабера для <!> и для <!>.
    Суммы Фаульхабера мною подробно анализировались в <!>`,1),Cr=l("Далее для вычисления нужно разложить <!> по формуле бинома Ньютона",1),zr=l("<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!>",1),Lr=l("<!> <!>",1),Mr=l("<!> <!>",1),Sr=l("<!> <!>",1),Tr=l(`Можно рассматривать суммы обратных <!>-х степеней натуральных чисел.
    Тогда мы получим обобщённые гармонические числа, которые тоже иногда встречаются при анализе алгоримтов`,1),wr=l("<!> <!>",1),Ar=l(`Справа написано <!>, а значит можно выразить <!> как
    сумму`,1),Dr=l(`Отсюда можно, например, получить значение <!> с большой сходимостью,
    порядка <!>`,1),Er=l("Переходя к пределу <!> получаем",1),Fr=l("где <!> &mdash; дзета-функция Римана, <!>",1),Gr=l("<!> <!> <!> <!> <!> <!> <!> <!> <!>",1),Ir=l("Значения <!>",1),Jr=l("<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!>",1);function ln(or){var L=Jr(),M=t(L);tr(M,{title:"Гармонические числа"});var S=r(M,2);H(S,{children:(e,p)=>{var a=fr(),m=t(a);i(m,{children:($,s)=>{var v=cr();_(),n($,v)}});var d=r(m,2);o(d,{display:!0,m:`H_n \\defeq 1 + \\frac{1}{2} + \\frac{1}{3} + \\frac{1}{4} + \\dotsb + \\frac{1}{n-1} + \\frac{1}{n}
          = \\sum_{k=1}^n \\frac{1}{k}`});var c=r(d,2);i(c,{children:($,s)=>{_();var v=P("Эти числа повсеместно встречаются в анализе алгоритмов.");n($,v)}}),n(e,a)}});var T=r(S,2);nr(T,{children:(e,p)=>{_();var a=P("Асимптотические формулы");n(e,a)}});var w=r(T,2);H(w,{children:(e,p)=>{var a=kr(),m=t(a);i(m,{children:(j,x)=>{_();var k=$r(),f=r(t(k));o(f,{m:"H_n \\sim \\ln n"});var y=r(f,2);o(y,{m:"H_n"}),_(),n(j,k)}});var d=r(m,2);o(d,{display:!0,m:`\\int_{1}^{n} \\frac{dx}{x} \\le H_n \\le 1 + \\int_{1}^n \\frac{dx}{x}
          \\iff \\ln n \\le H_n \\le 1 + \\ln n`});var c=r(d,2);i(c,{children:(j,x)=>{_();var k=ur(),f=r(t(k));o(f,{m:"\\ln n"}),_(),n(j,k)}});var $=r(c,2);o($,{display:!0,m:"H_n \\sim \\ln n \\quad\\text{при}~ n \\to \\oo"});var s=r($,2);i(s,{children:(j,x)=>{_();var k=pr(),f=r(t(k));o(f,{m:"\\gamma \\defeq \\lim_{n \\to \\oo} \\big( H_n - \\ln n \\big)"}),n(j,k)}});var v=r(s,2);o(v,{display:!0,m:"H_n = \\gamma + \\ln n + \\frac{1}{2n} - \\sum_{k=1}^\\oo \\frac{B_{2k}}{2k \\cdot n^{2k}}"}),n(e,a)}});var A=r(w,2);H(A,{children:(e,p)=>{i(e,{children:(a,m)=>{_();var d=P(`Асимптотическую формулу можно применять для нахождение времени работы алгоритмов.
    Например, следующая конструкция достаточно часто встречается`);n(a,d)}})}});var D=r(A,2);sr(D,{code:`for int i = 1; i <= n; i++:
    for int j = i; j <= n; j += i:
        do something`});var E=r(D,2);H(E,{children:(e,p)=>{var a=jr(),m=t(a);i(m,{children:(c,$)=>{_();var s=gr(),v=r(t(s));dr(v,{c:"do something"}),_(),n(c,s)}});var d=r(m,2);o(d,{display:!0,m:"\\sum_{j=1}^n \\left\\lfloor \\frac{n}{j} \\right\\rfloor \\le \\sum_{j=1}^n \\frac{n}{j} = n \\cdot H_n \\sim n \\ln n"}),n(e,a)}});var F=r(E,2);z(F,{children:(e,p)=>{_();var a=P("Гармонические суммы");n(e,a)}});var G=r(F,2);H(G,{children:(e,p)=>{i(e,{children:(a,m)=>{_();var d=P(`Гармонические числа постоянно встречаются в анализе алгоритмов, поэтому полезно будет заранее получить
    много полезных свойств, которыми обладают суммы с гармоническими числами.`);n(a,d)}})}});var I=r(G,2);nr(I,{children:(e,p)=>{_();var a=P("Степенные суммы");n(e,a)}});var J=r(I,2);H(J,{children:(e,p)=>{var a=Pr(),m=t(a);i(m,{children:(c,$)=>{_();var s=hr(),v=r(t(s));o(v,{m:"\\sum_{k=1}^n H_k"}),_(),n(c,s)}});var d=r(m,2);o(d,{display:!0,m:"\\sum_{k=1}^n H_k = \\sum_{k=1}^n \\sum_{j=1}^{k} \\frac{1}{j} = \\sum_{j=1}^n \\frac{n+1-j}{j} = (n+1) \\, H_n - n"}),n(e,a)}});var K=r(J,2);H(K,{children:(e,p)=>{var a=br(),m=t(a);i(m,{children:(c,$)=>{_();var s=Hr(),v=r(t(s));o(v,{m:"\\sum_{k=1}^n k^m \\, H_k"}),_(),n(c,s)}});var d=r(m,2);o(d,{display:!0,m:"\\sum_{k=1}^n k \\, H_k = \\sum_{k=1}^n \\sum_{j=1}^{k} \\frac{1}{j} = \\sum_{j=1}^n \\frac{n+1-j}{j} = (n+1) \\, H_n - n"}),n(e,a)}});var N=r(K,2);ir(N,{children:(e,p)=>{var a=Mr(),m=t(a);H(m,{children:(c,$)=>{var s=zr(),v=t(s);i(v,{children:(b,C)=>{var g=xr();_(),n(b,g)}});var j=r(v,2);i(j,{children:(b,C)=>{_();var g=yr(),q=r(t(g));o(q,{m:"\\sum_{k=1}^n k^m \\, H_k"}),_(),n(b,g)}});var x=r(j,2);o(x,{display:!0,m:"\\sum_{k=1}^n k^m \\, H_k = \\sum_{k=1}^n k^m \\sum_{j=1}^k \\frac{1}{j} = \\sum_{j=1}^n \\frac{1}{j} \\sum_{k=j}^n k^m"});var k=r(x,2);i(k,{children:(b,C)=>{_();var g=qr(),q=r(t(g));o(q,{m:"m"});var W=r(q,2);o(W,{m:"j"});var X=r(W,2);o(X,{m:"n"});var Y=r(X,2);o(Y,{m:"n"});var Z=r(Y,2);o(Z,{m:"j"});var er=r(Z,2);vr(er,{to:"",children:(mr,Kr)=>{_();var rr=Br(),lr=r(t(rr));o(lr,{m:"k"}),_(),n(mr,rr)},$$slots:{default:!0}}),n(b,g)}});var f=r(k,2);o(f,{display:!0,m:`\\sum_{k=j}^n k^m
      = \\sum_{k=1}^n k^m - \\sum_{k=1}^{j-1} k^m
      = \\frac{1}{m+1} \\sum_{\\ell=0}^m \\binom{m+1}{\\ell} \\, B_\\ell \\, \\bigl( n^{m+1-\\ell} - (j-1)^{m+1-\\ell} \\bigr)`});var y=r(f,2);i(y,{children:(b,C)=>{_();var g=P("Подставляем и считаем");n(b,g)}});var u=r(y,2);o(u,{display:!0,m:`\\align{
      \\sum_{k=1}^n k^m \\, H_k
      &= \\frac{1}{m+1} \\sum_{\\ell=0}^m \\binom{m+1}{\\ell} \\, B_\\ell \\cdot \\sum_{j=1}^n \\frac { n^{m+1-\\ell} - (j-1)^{m+1-\\ell} } {j} = \\\\
      &= \\frac{1}{m+1} \\sum_{\\ell=0}^m \\binom{m+1}{\\ell} \\, B_\\ell \\cdot \\left( n^{m+1-\\ell} \\, H_n - \\sum_{j=1}^n \\frac{(j-1)^{m+1-\\ell}}{j} \\right)
      }`});var h=r(u,2);i(h,{children:(b,C)=>{_();var g=Cr(),q=r(t(g));o(q,{m:"(j-1)^{m+1-\\ell}"}),_(),n(b,g)}});var B=r(h,2);o(B,{display:!0,m:`\\align{
      \\sum_{j=1}^n \\frac{(j-1)^{m+1-\\ell}}{j}
      &= \\sum_{j=1}^n \\sum_{i=0}^{m+1-\\ell} \\binom{m+1-\\ell}{i} \\, (-1)^{m+1-\\ell-i} \\, j^{i-1}
      = \\sum_{i=0}^{m+1-\\ell} \\binom{m+1-\\ell}{i} \\, (-1)^{m+1-\\ell-i} \\sum_{j=1}^n j^{i-1} =\\\\
      &= (-1)^{m+1-\\ell} \\, H_n + \\sum_{i=1}^{m+1-\\ell} \\binom{m+1-\\ell}{i} \\, (-1)^{m+1-\\ell-i} \\sum_{j=1}^n j^{i-1}
      }`});var V=r(B,2);i(V,{children:(b,C)=>{_();var g=P("Теперь осталась сумма Фаульхабера");n(b,g)}});var _r=r(V,2);o(_r,{display:!0,m:"\\sum_{j=1}^n j^{i-1} = \\frac{1}{i} \\sum_{s=0}^{i-1} \\binom{i}{s} \\, B_s \\, n^{i-s}"}),n(c,s)}});var d=r(m,2);H(d,{children:(c,$)=>{var s=Lr(),v=t(s);i(v,{children:(x,k)=>{_();var f=P("Можно собрать всё воедино");n(x,f)}});var j=r(v,2);o(j,{display:!0,m:`\\align{
      \\sum_{k=j}^n k^m \\, H_k =
      \\frac{1}{m+1} \\sum_{\\ell=0}^m \\binom{m+1}{\\ell} \\, B_\\ell
      \\cdot \\Biggl(& n^{m+1-\\ell} \\, H_n + (-1)^{m-\\ell} \\, H_n + \\\\ &+
          \\sum_{i=1}^{m+1-\\ell} \\binom{m+1-\\ell}{i} \\,
          \\frac{(-1)^{m-\\ell-i}}{i} \\sum_{s=0}^{i-1} \\binom{i}{s} \\, B_s \\, n^{i-s}
      \\Biggr)
      }`}),n(c,s)}}),n(e,a)}});var O=r(N,2);H(O,{children:(e,p)=>{var a=Sr(),m=t(a);i(m,{children:(c,$)=>{_();var s=P("Теперь некоторые значения сумм");n(c,s)}});var d=r(m,2);o(d,{display:!0,m:`\\align{
      \\sum_{k=1}^n k \\, H_k &= \\frac{n \\, (n+1)}{2} \\cdot H_n - \\frac{n \\, (n-1)}{4} \\\\
      \\sum_{k=1}^n k^2 \\, H_k &= \\frac{n \\, (n+1) \\, (2n+1)}{6} \\cdot H_n - \\frac{n \\, (n-1) \\, (4n+1)}{36} \\\\
      \\sum_{k=1}^n k^3 \\, H_k &= \\frac{n^2 \\, (n+1)^2}{4} \\cdot H_n - \\frac{n \\, (n-1) \\, (n+1) \\, (3n-2)}{48} \\\\
      \\sum_{k=1}^n k^4 \\, H_k &= \\frac{n \\, (n+1) \\, (2n+1) \\, (3n^2+3n-1)}{30} \\cdot H_n - \\frac{n \\, (n-1) \\, (72n^3+27n^2-103n-28)}{1800} \\\\
      \\sum_{k=1}^n k^5 \\, H_k &= \\frac{n^2 \\, (n+1)^2 \\, (2n^2+2n-1)}{12} \\cdot H_n - \\frac{n \\, (n-1) \\, (n+1) \\, (2n-1) \\, (10n^2-n-18)}{720} \\\\

      }`}),n(e,a)}});var Q=r(O,2);z(Q,{children:(e,p)=>{_();var a=P("Обобщённые гармонические числа");n(e,a)}});var R=r(Q,2);H(R,{children:(e,p)=>{var a=wr(),m=t(a);i(m,{children:(c,$)=>{_();var s=Tr(),v=r(t(s));o(v,{m:"s"}),_(),n(c,s)}});var d=r(m,2);o(d,{display:!0,m:`H^{(s)}_n \\defeq 1 + \\frac{1}{2^s} + \\frac{1}{3^s} + \\frac{1}{4^s} + \\dotsb + \\frac{1}{(n-1)^s} + \\frac{1}{n^s}
           = \\sum_{k=1}^n \\frac{1}{k^s}`}),n(e,a)}});var U=r(R,2);H(U,{children:(e,p)=>{var a=Gr(),m=t(a);i(m,{children:(f,y)=>{_();var u=P(`Обобщённые гармонические числа можно использовать, например, для приближения обычных гармонических чисел.
    Посмотрим на ряд`);n(f,u)}});var d=r(m,2);o(d,{display:!0,m:"\\ln \\left( \\frac{k}{k-1} \\right) = \\frac{1}{k} + \\frac{1}{2k^2} + \\frac{1}{3k^3} + \\frac{1}{4k^4} + \\dotsb = \\sum_{j=1}^\\oo \\frac{1}{j \\cdot k^j}"});var c=r(d,2);i(c,{children:(f,y)=>{_();var u=Ar(),h=r(t(u));o(h,{m:"\\ln k - \\ln (k-1)"});var B=r(h,2);o(B,{m:"\\ln n - \\ln 1"}),_(),n(f,u)}});var $=r(c,2);o($,{display:!0,m:"\\ln n - \\ln 1 = \\sum_{k=2}^n \\ln \\left( \\frac{k}{k-1} \\right) = \\sum_{k=2}^n \\sum_{j=1}^\\oo \\frac{1}{j \\cdot k^j} = \\sum_{j=1}^\\oo \\frac{H^{(j)}_n - 1}{j}"});var s=r($,2);i(s,{children:(f,y)=>{_();var u=Dr(),h=r(t(u));o(h,{m:"\\gamma"});var B=r(h,2);o(B,{m:"1/2^s"}),n(f,u)}});var v=r(s,2);o(v,{display:!0,m:"H_n - \\ln n = 1 - \\frac{1}{2} \\big( H^{(2)}_n - 1 \\big) - \\frac{1}{3} \\big( H^{(3)}_n - 1 \\big) - \\frac{1}{4} \\big( H^{(4)}_n - 1 \\big) - \\dotsb = 1 - \\sum_{s=2}^\\oo \\frac{H^{(j)}_n - 1}{j}"});var j=r(v,2);i(j,{children:(f,y)=>{_();var u=Er(),h=r(t(u));o(h,{m:"n \\to \\oo"}),_(),n(f,u)}});var x=r(j,2);o(x,{display:!0,m:"\\gamma = 1 - \\sum_{s=2}^\\oo \\frac{\\zeta(j) - 1}{j}"});var k=r(x,2);i(k,{children:(f,y)=>{_();var u=Fr(),h=r(t(u));o(h,{m:"\\zeta(j)"});var B=r(h,2);o(B,{m:"\\zeta(s) = \\sum_{k=1}^\\oo 1/k^s"}),n(f,u)}}),n(e,a)}});var ar=r(U,2);z(ar,{children:(e,p)=>{_();var a=Ir(),m=r(t(a));o(m,{m:"\\lfloor n/j \\rfloor"}),n(e,a)}}),n(or,L)}export{ln as component};
