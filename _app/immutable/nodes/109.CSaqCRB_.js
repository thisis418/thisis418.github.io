import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{f as s,a as t,b as v,s as r,n,t as k}from"../chunks/BWp35gWV.js";import{T as K}from"../chunks/CR7k0xtG.js";import{P as u}from"../chunks/DPzc5wQr.js";import{M as o}from"../chunks/BqyEoRxA.js";import{P as x}from"../chunks/B7flgP-x.js";import{H as L}from"../chunks/DXKx2xvL.js";import{T as N}from"../chunks/y0AHHn4v.js";import{C as F}from"../chunks/BvAJckrt.js";import{C as q}from"../chunks/BmgYHZay.js";/* empty css                */var O=s("Мы хотим генерировать случайное число с равномерным распределением на <!>.",1),Q=s("<!> <!>",1),R=s(`Выберем волшебные числа: <!> &mdash; модуль, <!> &mdash; множитель и <!> &mdash; приращение.
    При этом <!> и <!>.`,1),S=s("Будем строить последовательность величин <!>, начиная с заранее выбранного числа <!>.",1),U=s("<!> <!> <!> <!>",1),V=s(`Последовательность имеет вид <!>, где <!>.
    Все такие последовательности имеют цикл, поэтому она когда-то начнет повторяться.`,1),W=s("Например, для <!>, <!> и <!> при начальном значении <!> имеем последовательность",1),X=s("<!> <!> <!>",1),Y=s("От значений констант <!> и <!> сильно зависит случайность последовательности и ее период.",1),rr=s("При <!> период последовательности может оказаться меньше, чем при <!>.",1),or=s(`При <!> последовательность вообще не случайна,
    а при <!> получаем <!>, что тоже так себе.`,1),ar=s("Нам подходят только <!> и <!>.",1),er=s("<!> <!> <!> <!>",1),nr=s("Можно обобщить формулу для последовательности, выразив <!>-й член через <!>-й.",1),_r=s(`Получаем, что подпоследовательность последовательности <!>, содержащая каждый <!>-й член,
    также является линейной конгруэнтной последовательностью
    с множителем <!> и приращением <!>.`,1),dr=s("Отсюда же можно получить общую формулу для <!>-го члена последовательности <!>:",1),mr=s("<!> <!> <!> <!> <!>",1),vr=s(`Какое значение выбрать для модуля <!>?
    Он должен быть достаточно большим, ведь период последовательности не может быть больше <!>.
    Еще нам бы хотелось, чтобы <!> вычислялось не слишком долго.`,1),tr=s(`Самый перспективный вариант выбора <!> &mdash; машинное слово.
    При таком выборе дорогую операцию <!> вообще делать не надо, ведь она выполняется автоматически.`,1),sr=s(`Код такого преобразования <!>,
    где <!> и <!> &mdash; константы и <!> &mdash; машинное слово (я взял <!>-битное qword).
    В начале <!> будет хранится в регистре <!>,
    и результат вычислений окажется в том же регистре <!>.
    Все операции беззнаковые.`,1),lr=s("<!> <!> <!>",1),cr=s("Иногда бывает нужно брать не <!>, а <!>.",1),ir=s("Пусть <!> &mdash; простое число, и <!> &mdash; такое число, что <!>.",1),$r=s("Тогда если <!> и <!>",1),pr=s("<!> <!>",1),xr=s("<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!>",1);function Tr(G){var C=xr(),w=t(C);K(w,{title:"Линейный конгруэнтный метод"});var y=r(w,2);u(y,{children:(g,h)=>{var l=Q(),$=t(l);x($,{children:(c,i)=>{n();var d=O(),_=r(t(d));o(_,{m:"[0, 1]"}),n(),v(c,d)}});var p=r($,2);x(p,{children:(c,i)=>{n();var d=k(`Компьютер может хранить только числа конечного размера.
    Поэтому нам придется сгенерировать число, занимающее всё компьютерное слово.
    При таком подходе будем считать, что дробная точка стоит в начале этого слова.`);v(c,d)}}),v(g,l)}});var A=r(y,2);u(A,{children:(g,h)=>{var l=U(),$=t(l);x($,{children:(d,_)=>{n();var a=k("Посмотрим на наиболее часто применимый метод генерации таких простых чисел.");v(d,a)}});var p=r($,2);x(p,{children:(d,_)=>{n();var a=R(),e=r(t(a));o(e,{m:"m"});var m=r(e,2);o(m,{m:"a"});var f=r(m,2);o(f,{m:"c"});var P=r(f,2);o(P,{m:"0 \\le a \\lt m"});var b=r(P,2);o(b,{m:"0 \\le c \\lt m"}),n(),v(d,a)}});var c=r(p,2);x(c,{children:(d,_)=>{n();var a=S(),e=r(t(a));o(e,{m:"x_n"});var m=r(e,2);o(m,{m:"x_0"}),n(),v(d,a)}});var i=r(c,2);o(i,{display:!0,m:"x_{n+1} = (a \\cdot x_n + c) \\bmod m"}),v(g,l)}});var T=r(A,2);u(T,{children:(g,h)=>{var l=X(),$=t(l);x($,{children:(i,d)=>{n();var _=V(),a=r(t(_));o(a,{m:"x_{n+1} = f(x_n)"});var e=r(a,2);o(e,{m:"f \\colon \\ZZ_m \\to \\ZZ_m"}),n(),v(i,_)}});var p=r($,2);x(p,{children:(i,d)=>{n();var _=W(),a=r(t(_));o(a,{m:"m = 10"});var e=r(a,2);o(e,{m:"a = 3"});var m=r(e,2);o(m,{m:"c = 5"});var f=r(m,2);o(f,{m:"x_0 = 1"}),n(),v(i,_)}});var c=r(p,2);o(c,{display:!0,m:"x_0 = 1 \\quad x_1 = 8 \\quad x_2 = 9 \\quad x_3 = 2 \\quad x_4 = 1 \\quad x_5 = 8 \\quad x_6 = 9 \\quad x_7 = 2 \\quad x_8 = 1"}),v(g,l)}});var Z=r(T,2);u(Z,{children:(g,h)=>{var l=er(),$=t(l);x($,{children:(d,_)=>{n();var a=Y(),e=r(t(a));o(e,{m:"a"});var m=r(e,2);o(m,{m:"c"}),n(),v(d,a)}});var p=r($,2);x(p,{children:(d,_)=>{n();var a=rr(),e=r(t(a));o(e,{m:"c=0"});var m=r(e,2);o(m,{m:"c \\neq 0"}),n(),v(d,a)}});var c=r(p,2);x(c,{children:(d,_)=>{n();var a=or(),e=r(t(a));o(e,{m:"a=0"});var m=r(e,2);o(m,{m:"a=1"});var f=r(m,2);o(f,{m:"x_{n+1} = (x_0 + nc) \\bmod m"}),n(),v(d,a)}});var i=r(c,2);x(i,{children:(d,_)=>{n();var a=ar(),e=r(t(a));o(e,{m:"a \\ge 2"});var m=r(e,2);o(m,{m:"c \\ge 1"}),n(),v(d,a)}}),v(g,l)}});var H=r(Z,2);u(H,{children:(g,h)=>{var l=mr(),$=t(l);x($,{children:(_,a)=>{n();var e=nr(),m=r(t(e));o(m,{m:"(n+k)"});var f=r(m,2);o(f,{m:"n"}),n(),v(_,e)}});var p=r($,2);o(p,{display:!0,m:"x_{n+k} = \\big( a^k \\cdot x_n + (a^k-1) / (a-1) \\cdot c \\big) \\bmod m"});var c=r(p,2);x(c,{children:(_,a)=>{n();var e=_r(),m=r(t(e));o(m,{m:"x_n"});var f=r(m,2);o(f,{m:"k"});var P=r(f,2);o(P,{m:"a^k"});var b=r(P,2);o(b,{m:"(a^k-1) / (a-1) \\cdot c"}),n(),v(_,e)}});var i=r(c,2);x(i,{children:(_,a)=>{n();var e=dr(),m=r(t(e));o(m,{m:"n"});var f=r(m,2);o(f,{m:"x_n"}),n(),v(_,e)}});var d=r(i,2);o(d,{display:!0,m:"x_n = \\big( a^n \\cdot x_0 + (a^n-1) / (a-1) \\cdot c \\big) \\bmod m"}),v(g,l)}});var M=r(H,2);L(M,{children:(g,h)=>{n();var l=k("Выбор модуля");v(g,l)}});var j=r(M,2);u(j,{children:(g,h)=>{var l=lr(),$=t(l);x($,{children:(i,d)=>{n();var _=vr(),a=r(t(_));o(a,{m:"m"});var e=r(a,2);o(e,{m:"m"});var m=r(e,2);o(m,{m:"(a \\cdot x_n + c) \\bmod m"}),n(),v(i,_)}});var p=r($,2);x(p,{children:(i,d)=>{n();var _=tr(),a=r(t(_));o(a,{m:"m"});var e=r(a,2);o(e,{m:"\\bmod"}),n(),v(i,_)}});var c=r(p,2);x(c,{children:(i,d)=>{n();var _=sr(),a=r(t(_));o(a,{m:"x \\mapsto (\\code{A} \\cdot x + \\code{C}) \\bmod w"});var e=r(a,2);q(e,{c:"A"});var m=r(e,2);q(m,{c:"C"});var f=r(m,2);o(f,{m:"w"});var P=r(f,2);o(P,{m:"64"});var b=r(P,2);o(b,{m:"x"});var E=r(b,2);q(E,{language:"asm",c:"rax"});var J=r(E,2);q(J,{language:"asm",c:"rax"}),n(),v(i,_)}}),v(g,l)}});var z=r(j,2);F(z,{language:"asm",code:`
mov rax, x    ; x -> rax
imul A        ; rax * A -> rdx:rax
add rax, C    ; rax + C -> rax
`});var B=r(z,2);u(B,{children:(g,h)=>{x(g,{children:(l,$)=>{n();var p=cr(),c=r(t(p));o(c,{m:"m = w"});var i=r(c,2);o(i,{m:"m = w + 1"}),n(),v(l,p)}})}});var D=r(B,2);F(D,{language:"asm",code:`
mov rax, x
`});var I=r(D,2);N(I,{title:"Лемма о домножении",children:(g,h)=>{var l=pr(),$=t(l);x($,{children:(c,i)=>{n();var d=ir(),_=r(t(d));o(_,{m:"p"});var a=r(_,2);o(a,{m:"a"});var e=r(a,2);o(e,{m:"p^a > 2"}),n(),v(c,d)}});var p=r($,2);x(p,{children:(c,i)=>{n();var d=$r(),_=r(t(d));o(_,{m:"x \\eqmod{p^a} 1"});var a=r(_,2);o(a,{m:"x \\neqmod{p^{a+1}} 1"}),v(c,d)}}),v(g,l)}}),v(G,C)}export{Tr as component};
