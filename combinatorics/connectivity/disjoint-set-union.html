<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <link rel="icon" href="../../favicon.svg"/>
    <link rel="stylesheet" href="../../fonts/Inter/inter.css"/>
    <link rel="stylesheet" href="../../fonts/JetBrainsMono/jetbrainsmono.css"/>
    <link rel="stylesheet" href="../../variables.css"/>
    <link rel="stylesheet" href="../../global.css"/>
    <link rel="stylesheet" href="../../katex.css"/>

    <link rel="stylesheet" media="print" href="../../print.css">

    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    
		<link href="../../_app/immutable/assets/Link.Cb7NHG_N.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Button.DCPIk07g.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Icon.D0g2C4hd.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/0.ieOoEAmI.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/2.DXAScjb8.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Title.DPHn_YVg.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/P.BQjmqsBn.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/InternalCode.18_KRbfN.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Codeblock.CTVfIT4f.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Code.DJ30TqtG.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Heading.B4n5dO8q.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Math.oZcZgltA.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/BulletList.DQWRVM89.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/ListItem.BKpMqDLa.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Par.K_845M5t.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Block.BmKK-wfG.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Subheading.Sazqxtg1.css" rel="stylesheet">
		<link rel="modulepreload" href="../../_app/immutable/entry/start.Dkklk6Rf.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DsAObCLR.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/O64VAD6H.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BWp35gWV.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DIeogL5L.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/CNky9LEp.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/HEAPfHvV.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DkB2Co80.js">
		<link rel="modulepreload" href="../../_app/immutable/entry/app.Bva7xl9u.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/CWj6FrbW.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BOcoFmK4.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/MBbrtcMh.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/D-GYhs9T.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/0.LPgsIMBt.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/C9z9AdnA.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DDpIWRRY.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DlH7fH6r.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DvKvArtv.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DPocoKFO.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/UpSqMDag.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/69_IOA4Y.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/2.Di9RQfus.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/64.BmImStGc.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/CR7k0xtG.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/B7flgP-x.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BvAJckrt.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/CpJhWio5.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DAvg0_9P.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/i9XClpbl.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BmgYHZay.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DXKx2xvL.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BqyEoRxA.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/C2dv2nOL.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/CZ1-HcAj.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/NE91WFFs.js"><!--[--><!--]--><!--[--><!--]--><title>Система непересекающихся множеств</title>
</head>
<body data-sveltekit-preload-data="hover">
<div style="display: contents"><!--[--><!--[--><!----><header class="svelte-9v5dz7"><img src="/favicon.svg" alt="" role="presentation" class="svelte-9v5dz7"/> <button type="button" id="mobile-menu-button" class="subtle svelte-apk4jo"><!--[!--><svg viewBox="0 0 48 48" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="svelte-1tf3wrl" style="height: 1.5rem; margin: 0rem;"><path d="M40 12L8 12" stroke="currentColor" stroke-width="6" stroke-linecap="round"></path><path d="M40 24L8 24" stroke="currentColor" stroke-width="6" stroke-linecap="round"></path><path d="M40 36L8 36" stroke="currentColor" stroke-width="6" stroke-linecap="round"></path><!----></svg><!----> Меню<!----><!--]--></button><!----> <!--[--><nav class="svelte-9v5dz7"><!--[--><a href="/knowledge" class="svelte-1txvory colorless"><!---->База знаний<!----></a><a href="/scenario" class="svelte-1txvory colorless"><!---->Сценарий<!----></a><a href="/tasks" class="svelte-1txvory colorless"><!---->Задания<!----></a><a href="/rules" class="svelte-1txvory colorless"><!---->Правила игры<!----></a><!--]--></nav><!--]--></header> <!--[!--><!--]--><!----><!----> <main><!--[--><!----><article class="svelte-1cvbhgs"><!----><div class="title svelte-uw1xhm"><!--[!--><h1 class="svelte-uw1xhm">Система непересекающихся множеств</h1><!--]--></div><!----> <p class="svelte-xyzgp3"><!---->Система непересекающихся множеств — структура данных, позволяющая объединять непересекающиеся множества и
    отвечать на разные запросы про них.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Изначально у нас есть <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span><!----></span><!--]--><!----> элементов, каждый из которых находится в своем независимом множестве.
    Структура поддерживает несколько основных операций<!----></p><!----> <ul class="svelte-119ikxp"><li class="svelte-fa1o"><span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!----><span class="function">unite</span><span class="punctuation">(</span><span class="abstract-type">set</span> a<span class="punctuation">,</span> <span class="abstract-type">set</span> b<span class="punctuation">)</span><!----></code><!----></span><!----> — объединение двух множеств в одно<!----></li><!----> <li class="svelte-fa1o"><span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!----><span class="function">get</span><span class="punctuation">(</span><span class="builtin">object</span> x<span class="punctuation">)</span><!----></code><!----></span><!----> — получение множества, в котором находится данный элемент<!----></li><!----> <li class="svelte-fa1o"><span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!----><span class="function">size</span><span class="punctuation">(</span><span class="abstract-type">set</span> s<span class="punctuation">)</span><!----></code><!----></span><!----> — получение количества элементов в множестве<!----></li><!----><!----></ul><!----> <h1 class="svelte-mdj34r"><!---->Устройство структуры<!----></h1><!----> <p class="svelte-xyzgp3"><!---->Множества хранятся в виде корневых деревьев, а сами элементы множеств хранятся в вершинах.
    В корне дерева хранится представитель этого множества (лидер).
    В каждой вершине хранится ссылка на родителя.
    Если у какого-то элемента ссылка на родителя указывает на него же, то этот элемент является
    лидером.
    Операция получения множества, в котором хранится данный элемент, будет возвращать нам лидера этого множества.
    При объединении двух множеств деревья объединяются: корень одного дерева подвешивается к корню другого.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Пусть, для простоты, элементы множеств пронумерованы от <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span><!----></span><!--]--><!----> до <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->.
    Родителей элементов можно хранить в массиве <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->parents<!----></code><!----></span><!---->, тогда родитель элемента <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->x<!----></code><!----></span><!----> —
    элемент <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->parent<span class="punctuation">[</span>x<span class="punctuation">]</span><!----></code><!----></span><!---->.<!----></p><!----> <p class="svelte-xyzgp3"><!---->При инициализации структуры каждый элемент должен попасть в свое собственное независимое множество<!----></p><!----> <div class="codeblock svelte-in28rj"><div class="overflow-box svelte-in28rj"><code class="language-pseudocode svelte-127l4oe"><!----><span class="abstract-type">array</span><span class="punctuation">[</span><span class="builtin">int</span><span class="punctuation">]</span> parents<span class="punctuation">[</span>n<span class="punctuation">]</span>

<span class="keyword">for</span> i <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> i <span class="operator">&lt;</span> n<span class="punctuation">:</span>
    parents<span class="punctuation">[</span>i<span class="punctuation">]</span> <span class="operator">=</span> i<!----></code><!----></div></div><!----> <h1 class="svelte-mdj34r"><!---->Наивная реализация<!----></h1><!----> <p class="svelte-xyzgp3"><!---->Каждое множество в структуре связано со своим лидером.
    Операция <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->get<!----></code><!----></span><!----> будет возвращать лидера множества, в котором содержится элемент <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->x<!----></code><!----></span><!---->.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Для выполнения операции нужно просто пройтись вверх по дереву, пока не дойдем до лидера.<!----></p><!----> <div class="codeblock svelte-in28rj"><div class="overflow-box svelte-in28rj"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">function</span> <span class="function">get</span><span class="punctuation">(</span><span class="builtin">int</span> x<span class="punctuation">)</span> <span class="operator">-</span><span class="operator">&gt;</span> <span class="builtin">int</span><span class="punctuation">:</span>
    <span class="keyword">if</span> parent<span class="punctuation">[</span>x<span class="punctuation">]</span> <span class="operator">==</span> x<span class="punctuation">:</span>
        <span class="keyword">return</span> x
    <span class="keyword">else</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="function">get</span><span class="punctuation">(</span>parent<span class="punctuation">[</span>x<span class="punctuation">]</span><span class="punctuation">)</span><!----></code><!----></div></div><!----> <p class="svelte-xyzgp3"><!---->Для объединения двух множеств достаточно подвесить одно дерево к другому. Для этого найдем корни каждого дерева
    (лидеры каждого множества) и перезапишем ссылку на родителя одного из них.<!----></p><!----> <div class="codeblock svelte-in28rj"><div class="overflow-box svelte-in28rj"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">function</span> <span class="function">unite</span><span class="punctuation">(</span><span class="builtin">int</span> a<span class="punctuation">,</span> <span class="builtin">int</span> b<span class="punctuation">)</span><span class="punctuation">:</span>
    a <span class="operator">=</span> <span class="function">get</span><span class="punctuation">(</span>a<span class="punctuation">)</span>
    b <span class="operator">=</span> <span class="function">get</span><span class="punctuation">(</span>b<span class="punctuation">)</span>
    parent<span class="punctuation">[</span>a<span class="punctuation">]</span> <span class="operator">=</span> b<!----></code><!----></div></div><!----> <p class="svelte-xyzgp3"><!---->При такой реализации обе операции занимают время <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!---->, потому что дерево может оказаться бамбуком.<!----></p><!----> <h1 class="svelte-mdj34r"><!---->Эвристика сжатия пути<!----></h1><!----> <p class="svelte-xyzgp3"><!---->Давайте ускорим операцию <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->get<!----></code><!----></span><!---->. После того, как мы нашли лидера множества, в котором находится элемент <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span><!----></span><!--]--><!----> мы можем подвесить <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->x<!----></code><!----></span><!----> к этому лидеру. Тогда последующие выполнения операции <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!----><span class="function">get</span><span class="punctuation">(</span>x<span class="punctuation">)</span><!----></code><!----></span><!----> будут работать за время <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!----> (естественно, при условии, что это множество ни с кем не
    объединяется).<!----></p><!----> <div class="codeblock svelte-in28rj"><div class="overflow-box svelte-in28rj"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">function</span> <span class="function">get</span><span class="punctuation">(</span><span class="builtin">int</span> x<span class="punctuation">)</span> <span class="operator">-</span><span class="operator">&gt;</span> <span class="builtin">int</span><span class="punctuation">:</span>
    <span class="keyword">if</span> parent<span class="punctuation">[</span>x<span class="punctuation">]</span> <span class="operator">==</span> x<span class="punctuation">:</span>
        <span class="keyword">return</span> x
    <span class="keyword">else</span><span class="punctuation">:</span>
        parent<span class="punctuation">[</span>x<span class="punctuation">]</span> <span class="operator">=</span> <span class="function">get</span><span class="punctuation">(</span>parent<span class="punctuation">[</span>x<span class="punctuation">]</span><span class="punctuation">)</span>
        <span class="keyword">return</span> parent<span class="punctuation">[</span>x<span class="punctuation">]</span><!----></code><!----></div></div><!----> <p class="svelte-xyzgp3"><!---->Этот прием называется <b>эвристикой сжатия пути</b>. Действительно, мы «сжимаем» путь до корня,
    подвешивая все его вершины к корню.<!----></p><!----><!----><!----></article> <div class="svelte-1cvbhgs"></div><!----><!--]--><!----></main><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_1h7j5ru = {
						base: new URL("../..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../../_app/immutable/entry/start.Dkklk6Rf.js"),
						import("../../_app/immutable/entry/app.Bva7xl9u.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2, 64],
							data: [null,null,null],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
</body>
</html>
