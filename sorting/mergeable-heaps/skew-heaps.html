<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <link rel="icon" href="../../favicon.svg"/>
    <link rel="stylesheet" href="../../fonts/Inter/inter.css"/>
    <link rel="stylesheet" href="../../fonts/JetBrainsMono/jetbrainsmono.css"/>
    <link rel="stylesheet" href="../../variables.css"/>
    <link rel="stylesheet" href="../../global.css"/>
    <link rel="stylesheet" href="../../katex.css"/>

    <link rel="stylesheet" media="print" href="../../print.css">

    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    
		<link href="../../_app/immutable/assets/Link.Cb7NHG_N.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Button.DCPIk07g.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Icon.D0g2C4hd.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/0.ieOoEAmI.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/2.DXAScjb8.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Title.DPHn_YVg.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Par.K_845M5t.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/P.BQjmqsBn.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Math.oZcZgltA.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/InternalCode.18_KRbfN.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Code.DJ30TqtG.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Codeblock.CTVfIT4f.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Heading.B4n5dO8q.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Subheading.Sazqxtg1.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Block.BmKK-wfG.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Proof.BeOUDyan.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Image.4MnJTrhn.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/EnumList.CtnWplwG.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/ListItem.BKpMqDLa.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/BulletList.DQWRVM89.css" rel="stylesheet">
		<link rel="modulepreload" href="../../_app/immutable/entry/start.Dkklk6Rf.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DsAObCLR.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/O64VAD6H.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BWp35gWV.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DIeogL5L.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/CNky9LEp.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/HEAPfHvV.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DkB2Co80.js">
		<link rel="modulepreload" href="../../_app/immutable/entry/app.Bva7xl9u.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/CWj6FrbW.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BOcoFmK4.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/MBbrtcMh.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/D-GYhs9T.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/0.LPgsIMBt.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/C9z9AdnA.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DDpIWRRY.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DlH7fH6r.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DvKvArtv.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DPocoKFO.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/UpSqMDag.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/69_IOA4Y.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/2.Di9RQfus.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/135.DVw0rYmz.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/CR7k0xtG.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DPzc5wQr.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/B7flgP-x.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BqyEoRxA.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DAvg0_9P.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/C2dv2nOL.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BmgYHZay.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/CpJhWio5.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/i9XClpbl.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BvAJckrt.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DXKx2xvL.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/CBbFRhrb.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DlTIf4aM.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/B53uy30Q.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/y0AHHn4v.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BBkyo9uE.js"><!--[--><!--]--><!--[--><!--]--><title>Скошенные и левосторонние кучи</title>
</head>
<body data-sveltekit-preload-data="hover">
<div style="display: contents"><!--[--><!--[--><!----><header class="svelte-9v5dz7"><img src="/favicon.svg" alt="" role="presentation" class="svelte-9v5dz7"/> <button type="button" id="mobile-menu-button" class="subtle svelte-apk4jo"><!--[!--><svg viewBox="0 0 48 48" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="svelte-1tf3wrl" style="height: 1.5rem; margin: 0rem;"><path d="M40 12L8 12" stroke="currentColor" stroke-width="6" stroke-linecap="round"></path><path d="M40 24L8 24" stroke="currentColor" stroke-width="6" stroke-linecap="round"></path><path d="M40 36L8 36" stroke="currentColor" stroke-width="6" stroke-linecap="round"></path><!----></svg><!----> Меню<!----><!--]--></button><!----> <!--[--><nav class="svelte-9v5dz7"><!--[--><a href="/knowledge" class="svelte-1txvory colorless"><!---->База знаний<!----></a><a href="/scenario" class="svelte-1txvory colorless"><!---->Сценарий<!----></a><a href="/tasks" class="svelte-1txvory colorless"><!---->Задания<!----></a><a href="/rules" class="svelte-1txvory colorless"><!---->Правила игры<!----></a><!--]--></nav><!--]--></header> <!--[!--><!--]--><!----><!----> <main><!--[--><!----><article class="svelte-1cvbhgs"><!----><div class="title svelte-uw1xhm"><!--[!--><h1 class="svelte-uw1xhm">Скошенные и левосторонние кучи</h1><!--]--></div><!----> <h1 class="svelte-mdj34r"><!---->Левосторонняя куча<!----></h1><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><b>Свободная позиция</b> в двоичном дереве — место, куда может быть вставлен новый узел.
    То есть, если у какого-то узла нет какого-то ребёнка,
    то место этого несуществующего ребёнка является свободной позицией.<!----></p><!----></div><!----> <div class="block svelte-1socrhn theorem"><h3 class="svelte-1socrhn"><svg viewBox="0 0 48 48" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="svelte-1tf3wrl" style="height: 1.25rem; margin: 0rem;"><path d="M15.436 34H32.565C33.005 33.467 33.541 32.905 34.117 32.305C36.6 29.72 40 26.179 40 20C40 11.178 32.822 4 24 4C15.178 4 8 11.178 8 20C8 26.179 11.4 29.72 13.883 32.305C14.46 32.905 14.996 33.467 15.436 34ZM16.733 37C17.146 38.894 17.513 40.476 17.513 40.476C17.974 42.551 19.781 44 21.906 44H26.094C28.219 44 30.025 42.551 30.483 40.491C30.483 40.491 30.853 38.902 31.267 37H16.733Z"></path><!----></svg><!----> <!--[!-->Теорема о минимальной свободной позиции<!--]--></h3> <p class="svelte-xyzgp3"><!---->В бинарном дереве, содержащем <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span><!----></span><!--]--><!----> вершин,
    существует свободная позиция на глубине не более <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌊</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">⌋</mo></mrow><annotation encoding="application/x-tex">\lfloor \log_2 (n+1) \rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌊</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)⌋</span></span></span></span><!----></span><!--]--><!---->.<!----></p><!----></div><!----> <div class="proof svelte-17zasab"><p class="svelte-xyzgp3"><!---->Если бы каждая свободная позиция была бы на глубине более <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mi>n</mi></mrow><annotation encoding="application/x-tex">\log_2 n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9386em;vertical-align:-0.2441em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span></span></span></span><!----></span><!--]--><!---->,
    то мы получили бы полное совершенное бинарное дерево с более чем <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span><!----></span><!--]--><!----> элементами.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Для получения точной оценки достаточно рассмотреть полное бинарное дерево,
    в котором все свободные позиции находятся наиболее низко.<!----></p><!----><!----></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Давайте используем этот факт и сконструируем левостороннее дерево.
    Нам нужно потребовать выполнение следующего условия:
    ближайшая к корню свободная позиция должна быть самой правой позицией в дереве.
    Давайте формализуем и переформулируем в полее приятном виде.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Пусть <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">dist</mi><mo>⁡</mo><mi>v</mi></mrow><annotation encoding="application/x-tex">\dist v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mop"><span class="mord mathrm">dist</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><!----></span><!--]--><!----> (free distance) — расстояние от узла <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><!----></span><!--]--><!----> до ближайшей свободной позиции в поддереве с корнем в <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><!----></span><!--]--><!---->.
    У пустых узлов <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">dist</mi><mo>⁡</mo><mo stretchy="false">(</mo><mtext>none</mtext><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\dist (\code{\htmlClass{boolean}{none}}) = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">dist</span></span><span class="mopen">(</span><span class="enclosing code"><span class="mord text"><span class="enclosing boolean"><span class="mord">none</span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span><!----></span><!--]--><!---->.
    Теперь наше требование можно переформулировать в более приятной форме:<!----></p><!----> <!--[--><div class="math-display svelte-16qk674"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">dist</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>v</mi><mi mathvariant="normal">.</mi><mtext>left</mtext><mo stretchy="false">)</mo><mo>⩾</mo><mi mathvariant="normal">dist</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>v</mi><mi mathvariant="normal">.</mi><mtext>right</mtext><mo stretchy="false">)</mo><mspace width="1em"/><mtext>для всех узлов </mtext><mi>v</mi></mrow><annotation encoding="application/x-tex">\dist ( v.\code{left} ) \ge \dist (v.\code{right}) \quad\text{для всех узлов}~ v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">dist</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">.</span><span class="enclosing code"><span class="mord text"><span class="mord">left</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⩾</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">dist</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">.</span><span class="enclosing code"><span class="mord text"><span class="mord">right</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord cyrillic_fallback">для</span><span class="mord"> </span><span class="mord cyrillic_fallback">всех</span><span class="mord"> </span><span class="mord cyrillic_fallback">узлов</span></span><span class="mspace nobreak"> </span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></span><!----></div><!--]--><!----> <p class="svelte-xyzgp3"><!---->Если вдруг, для какого-то узла это свойство не выполняется,
    то можно поменять местами указатели на правого и левого детей местами.
    После этого свойство левостороннего дерева для этой вершины будет выполняться.<!----></p><!----><!----></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Возьмём левостороннее дерево и потребуем еще дополнительно, чтобы для него выполнялось свойство кучи:
    приоритет любого узла больше приоритета его детей.
    Мы превратили левостороннее дерево в левостороннюю кучу.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Узлы такой левосторонней кучи должны хранить указатели на левого и правого ребёнка,
    а так же значение <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">dist</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\dist(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">dist</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!---->, для того, чтобы не нужно было его пересчитывать каждый раз.<!----></p><!----><!----></div><!----> <div class="codeblock svelte-in28rj"><div class="overflow-box svelte-in28rj"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">struct</span> <span class="class-name">node</span><span class="punctuation">:</span>
    <span class="class-name">node</span><span class="operator">*</span> left
    <span class="class-name">node</span><span class="operator">*</span> right
    <span class="builtin">int</span> dist
    <span class="builtin">int</span> <span class="builtin">priority</span><!----></code><!----></div></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->При вычислении <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">dist</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\dist(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">dist</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!----> для узла <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><!----></span><!--]--><!----> нужно отдельно проверить,
    не является ли этот узел <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!----><span class="boolean">none</span><!----></code><!----></span><!---->. Для удобства можно завести отдельную функцию,
    которую, кстати, надо инлайнить.<!----></p><!----></div><!----> <div class="codeblock svelte-in28rj"><div class="overflow-box svelte-in28rj"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">function</span> <span class="function">get_dist</span><span class="punctuation">(</span><span class="class-name">node</span> x<span class="punctuation">)</span><span class="punctuation">:</span>
    <span class="keyword">if</span> x <span class="keyword">is</span> <span class="boolean">none</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="number">0</span>
    <span class="keyword">else</span><span class="punctuation">:</span>
        <span class="keyword">return</span> x<span class="punctuation">.</span>dist<!----></code><!----></div></div><!----> <h1 class="svelte-1trpu2y"><!---->Слияние левосторонних куч<!----></h1><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Воспользуемся тем, что куча левосторонняя.
    Правое поддерево — самое короткое и не длиннее <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\log n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span></span></span></span><!----></span><!--]--><!---->.
    Поэтому пойдём направо и сольем правое поддерево с кучей.<!----></p><!----></div><!----> <div class="codeblock svelte-in28rj"><div class="overflow-box svelte-in28rj"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">function</span> <span class="function">merge</span><span class="punctuation">(</span><span class="class-name">node</span><span class="operator">*</span> x<span class="punctuation">,</span> <span class="class-name">node</span><span class="operator">*</span> y<span class="punctuation">)</span><span class="punctuation">:</span>  <span class="comment"># x и y являются корнями сливаемых куч</span>
    <span class="keyword">if</span> x <span class="keyword">is</span> <span class="boolean">none</span><span class="punctuation">:</span>
        <span class="keyword">return</span> y

    <span class="keyword">if</span> y <span class="keyword">is</span> <span class="boolean">none</span><span class="punctuation">:</span>
        <span class="keyword">return</span> x

   <span class="keyword">if</span> y<span class="punctuation">.</span><span class="builtin">priority</span> <span class="operator">&gt;</span> x<span class="punctuation">.</span><span class="builtin">priority</span><span class="punctuation">:</span>
       <span class="keyword">swap</span> x<span class="punctuation">,</span> y

   x<span class="punctuation">.</span>right <span class="operator">=</span> <span class="function">merge</span><span class="punctuation">(</span>x<span class="punctuation">.</span>right<span class="punctuation">,</span> y<span class="punctuation">)</span>

   <span class="keyword">if</span> <span class="function">get_dist</span><span class="punctuation">(</span>x<span class="punctuation">.</span>right<span class="punctuation">)</span> <span class="operator">&gt;</span> <span class="function">get_dist</span><span class="punctuation">(</span>x<span class="punctuation">.</span>left<span class="punctuation">)</span><span class="punctuation">:</span>
       <span class="keyword">swap</span> x<span class="punctuation">.</span>left<span class="punctuation">,</span> x<span class="punctuation">.</span>right

   x<span class="punctuation">.</span>dist <span class="operator">=</span> <span class="function">get_dist</span><span class="punctuation">(</span>x<span class="punctuation">.</span>right<span class="punctuation">)</span> <span class="operator">+</span> <span class="number">1</span>

   <span class="keyword">return</span> x<!----></code><!----></div></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Мы вызываем слияние рекурсивно, при этом каждый рекурсивный вызов у одной из сливаемых куч уменьшается высота.
    Значит, слияние будет работать за время <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!---->.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Более точно, слияние двух куч <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">H_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><!----></span><!--]--><!----> и <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">H_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><!----></span><!--]--><!----> с размерами <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">n_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><!----></span><!--]--><!----> и <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">n_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><!----></span><!--]--><!----> потребует <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">dist</mi><mo>⁡</mo><msub><mi>H</mi><mn>1</mn></msub><mo>+</mo><mi mathvariant="normal">dist</mi><mo>⁡</mo><msub><mi>H</mi><mn>2</mn></msub><mo>=</mo><mo stretchy="false">⌊</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mo stretchy="false">(</mo><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">⌋</mo><mo>+</mo><mo stretchy="false">⌊</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mo stretchy="false">(</mo><msub><mi>n</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">⌋</mo></mrow><annotation encoding="application/x-tex">\dist H_1 + \dist H_2 = \lfloor \log_2 (n_1 + 1) \rfloor + \lfloor \log_2 (n_2 + 1) \rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mop"><span class="mord mathrm">dist</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mop"><span class="mord mathrm">dist</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌊</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)⌋</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌊</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)⌋</span></span></span></span><!----></span><!--]--><!----> рекурсивных вызовов.<!----></p><!----><!----></div><!----> <h1 class="svelte-1trpu2y"><!---->Построение левосторонней кучи<!----></h1><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Пусть дан массив <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span><!----></span><!--]--><!----> размера <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span><!----></span><!--]--><!----> с элементами, которые нужно собрать в кучу.
    Создадим из каждого элемента <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">A[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span><!----></span><!--]--><!----> отдельную левостороннюю кучу (один узел с <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">dist</mi><mo>⁡</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\dist = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mop"><span class="mord mathrm">dist</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->),
    а затем будем объединять их в пары, пока не останется одна куча.<!----></p><!----></div><!----> <div class="codeblock svelte-in28rj"><div class="overflow-box svelte-in28rj"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">function</span> <span class="function">build_leftist_heap</span><span class="punctuation">(</span>A<span class="punctuation">:</span> <span class="abstract-type">array</span><span class="punctuation">[</span><span class="builtin">int</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">:</span>
    n <span class="operator">=</span> A<span class="punctuation">.</span><span class="builtin">length</span>
    <span class="keyword">if</span> n <span class="operator">==</span> <span class="number">0</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="boolean">none</span>

    heaps <span class="operator">=</span> <span class="punctuation">[</span><span class="function">new_node</span><span class="punctuation">(</span>A<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">)</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span> <span class="punctuation">.</span><span class="punctuation">.</span> n<span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span> <span class="comment"># Создаём массив куч по одной куче на элемент</span>

    <span class="keyword">while</span> heaps<span class="punctuation">.</span><span class="builtin">length</span> <span class="operator">&gt;</span> <span class="number">1</span><span class="punctuation">:</span>
        next_heaps <span class="operator">=</span> <span class="punctuation">[</span><span class="punctuation">]</span>
        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> heaps<span class="punctuation">.</span><span class="builtin">length</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">:</span>
            left_heap <span class="operator">=</span> heaps<span class="punctuation">[</span>i<span class="punctuation">]</span>
            <span class="keyword">if</span> i <span class="operator">+</span> <span class="number">1</span> <span class="operator">&lt;</span> heaps<span class="punctuation">.</span><span class="builtin">length</span><span class="punctuation">:</span>
                right_heap <span class="operator">=</span> heaps<span class="punctuation">[</span>i <span class="operator">+</span> <span class="number">1</span><span class="punctuation">]</span>
            <span class="keyword">else</span><span class="punctuation">:</span>
                right_heap <span class="operator">=</span> <span class="boolean">none</span>
            merged <span class="operator">=</span> <span class="function">merge</span><span class="punctuation">(</span>left_heap<span class="punctuation">,</span> right_heap<span class="punctuation">)</span>
            next_heaps<span class="punctuation">.</span><span class="function">append</span><span class="punctuation">(</span>merged<span class="punctuation">)</span>
        heaps <span class="operator">=</span> next_heaps

<span class="keyword">return</span> heaps<span class="punctuation">[</span><span class="number">0</span><span class="punctuation">]</span><!----></code><!----></div></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->На каждом уровне итерации объединений количество куч уменьшается вдвое, а общее число операций <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->merge<!----></code><!----></span><!----> — <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo>+</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>4</mn><mo>+</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>+</mo><mo>⋯</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n/2 + n/4 + n/8 + \dotsb = O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!---->. Каждая операция <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->merge<!----></code><!----></span><!----> в худшем случае занимает <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!---->,
    но так как размеры куч в начале малы, общая сложность построения — <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n \log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!---->.<!----></p><!----></div><!----> <h1 class="svelte-1trpu2y"><!---->Вставка<!----></h1><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Вставка нового элемента в кучу очень просто реализуется слиянием.
    Создаём новую левостороннюю кучу, состоящую только из одного элемента — вставляемого.
    Далее сливаем нашу новую кучу с исходной кучей, в которую вставляем элемент.<!----></p><!----></div><!----> <h1 class="svelte-1trpu2y"><!---->Извлечение минимума<!----></h1><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Минимум находится в корне, поэтому для извлечения минимума
    достаточно просто удалить корень и слить его правое и левое поддеревья.<!----></p><!----></div><!----> <h1 class="svelte-mdj34r"><!---->Скошенная куча<!----></h1><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Скошенная куча (skew heap) — это разновидность левосторонней кучи, в которой отсутствует необходимость хранить и
    поддерживать значение <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">dist</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\dist(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">dist</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!----> для каждого узла.
    Вместо этого скошенная куча на каждом шаге операции слияния она <b>обязательно меняет местами левого и правого
    потомков</b> у текущего узла.
    Это позволяет обойтись без хранения вспомогательных данных, при этом сохраняя амортизированную эффективность.<!----></p><!----></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Узел скошенной кучи содержит только указатели на левого и правого потомков и значение приоритета.<!----></p><!----></div><!----> <div class="codeblock svelte-in28rj"><div class="overflow-box svelte-in28rj"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">struct</span> <span class="class-name">node</span><span class="punctuation">:</span>
    <span class="class-name">node</span><span class="operator">*</span> left
    <span class="class-name">node</span><span class="operator">*</span> right
    <span class="builtin">int</span> <span class="builtin">priority</span><!----></code><!----></div></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Операция <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->merge<!----></code><!----></span><!----> — основная для скошенной кучи. В отличие от левосторонней кучи, где на каждом шаге
    проверяется и поддерживается свойство <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">dist</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">\dist</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mop"><span class="mord mathrm">dist</span></span></span></span></span><!----></span><!--]--><!---->, в скошенной куче мы просто меняем местами
    левого и правого потомков после рекурсивного слияния.<!----></p><!----></div><!----> <div class="codeblock svelte-in28rj"><div class="overflow-box svelte-in28rj"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">function</span> <span class="function">merge</span><span class="punctuation">(</span><span class="class-name">node</span><span class="operator">*</span> x<span class="punctuation">,</span> <span class="class-name">node</span><span class="operator">*</span> y<span class="punctuation">)</span><span class="punctuation">:</span>
    <span class="keyword">if</span> x <span class="keyword">is</span> <span class="boolean">none</span><span class="punctuation">:</span>
        <span class="keyword">return</span> y

    <span class="keyword">if</span> y <span class="keyword">is</span> <span class="boolean">none</span><span class="punctuation">:</span>
        <span class="keyword">return</span> x

    <span class="keyword">if</span> y<span class="punctuation">.</span><span class="builtin">priority</span> <span class="operator">&lt;</span> x<span class="punctuation">.</span><span class="builtin">priority</span><span class="punctuation">:</span>
        <span class="keyword">swap</span> x<span class="punctuation">,</span> y

    x<span class="punctuation">.</span>left <span class="operator">=</span> <span class="function">merge</span><span class="punctuation">(</span>x<span class="punctuation">.</span>left<span class="punctuation">,</span> y<span class="punctuation">)</span>
    <span class="keyword">swap</span> x<span class="punctuation">.</span>left<span class="punctuation">,</span> x<span class="punctuation">.</span>right

    <span class="keyword">return</span> x<!----></code><!----></div></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Помимо <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->merge<!----></code><!----></span><!---->, все операции реализуются идентично левосторонней куче, то есть
    построение/вставка/удаление отличаются, только приниципом работы функции <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->merge<!----></code><!----></span><!---->.<!----></p><!----></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Как мы поняли в отличие от левосторонней кучи, в скошенной куче не проверяется
    соотношение между левым и правым поддеревом.
    Вместо этого, после рекурсивного вызова <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!----><span class="function">merge</span><span class="punctuation">(</span>x<span class="punctuation">.</span>left<span class="punctuation">,</span> y<span class="punctuation">)</span><!----></code><!----></span><!---->, мы <b>всегда</b> меняем местами левого и правого потомков у <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->x<!----></code><!----></span><!---->.
    Из этого следует явное замечание о том, что в худшем случаем <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->merge<!----></code><!----></span><!----> имеет
    сложность <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!----> операций, но вся ассимптотическая прелесть скошенной кучи раскрывается при большом
    количестве операций <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->merge<!----></code><!----></span><!---->, что бы удостовериться в этом проведем амортизационный анализ.<!----></p><!----></div><!----> <h1 class="svelte-mdj34r"><!---->Амортизационный анализ скошенной кучи<!----></h1><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Для того что бы найти примерную сложность операции <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->merge<!----></code><!----></span><!----> воспользуемся потенциальным методом анализа.<!----></p><!----></div><!----> <div class="block svelte-1socrhn definition"><h3 class="svelte-1socrhn"><svg viewBox="0 0 48 48" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="svelte-1tf3wrl" style="height: 1.25rem; margin: 0rem;"><path d="M30 40L30 8" stroke="currentColor" stroke-width="6" stroke-linecap="round"></path><path d="M18 40L18 8" stroke="currentColor" stroke-width="6" stroke-linecap="round"></path><path d="M40 18L8 18" stroke="currentColor" stroke-width="6" stroke-linecap="round"></path><path d="M40 30L8 30" stroke="currentColor" stroke-width="6" stroke-linecap="round"></path><!----></svg><!----> <!--[!-->Потенциал скошенной кучи<!--]--></h3> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Пусть <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span><!----></span><!--]--><!----> — скошенная куча. Определим её <b>потенциал</b> <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><mi>H</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Phi(H)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Φ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!----> как количество
    правых детей в дереве, то есть число узлов, которые являются правыми потомками своих родителей.<!----></p><!----></div><!----></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Интуитивно заметно, что потенциал измеряет «несбалансированность» кучи,
    то есть  чем больше правых потомков, тем выше потенциал.
    При каждом вызове <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->merge<!----></code><!----></span><!----> мы меняем местами левого и правого потомков у корня,
    что может уменьшить потенциал, компенсируя стоимость будущих операций.<!----></p><!----></div><!----> <div class="block svelte-1socrhn theorem"><h3 class="svelte-1socrhn"><svg viewBox="0 0 48 48" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="svelte-1tf3wrl" style="height: 1.25rem; margin: 0rem;"><path d="M15.436 34H32.565C33.005 33.467 33.541 32.905 34.117 32.305C36.6 29.72 40 26.179 40 20C40 11.178 32.822 4 24 4C15.178 4 8 11.178 8 20C8 26.179 11.4 29.72 13.883 32.305C14.46 32.905 14.996 33.467 15.436 34ZM16.733 37C17.146 38.894 17.513 40.476 17.513 40.476C17.974 42.551 19.781 44 21.906 44H26.094C28.219 44 30.025 42.551 30.483 40.491C30.483 40.491 30.853 38.902 31.267 37H16.733Z"></path><!----></svg><!----> <!--[!-->Амортизированная сложность слияния<!--]--></h3> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Амортизированная стоимость операции <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->merge<!----></code><!----></span><!----> для двух скошенных куч с суммарным размером <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span><!----></span><!--]--><!----> составляет <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!---->.<!----></p><!----></div><!----></div><!----> <div class="proof svelte-17zasab"><div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Пусть операция <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->merge<!----></code><!----></span><!----> выполняет <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span><!----></span><!--]--><!----> рекурсивных вызовов.
    В худшем случае <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">t = O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!---->, но рассмотрим амортизированную стоимость <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>c</mi><mo>^</mo></mover><mo>=</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">Φ</mi></mrow><annotation encoding="application/x-tex">\hat{c} = t + \Delta\Phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">c</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6984em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">ΔΦ</span></span></span></span><!----></span><!--]--><!---->,
    где <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span><!----></span><!--]--><!----> — реальная стоимость (число рекурсивных вызовов),
    а <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">Φ</mi><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mtext>после</mtext></msub><mo>−</mo><msub><mi mathvariant="normal">Φ</mi><mtext>до</mtext></msub></mrow><annotation encoding="application/x-tex">\Delta\Phi = \Phi_{\text{после}} - \Phi_{\text{до}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">ΔΦ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cyrillic_fallback mtight">после</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cyrillic_fallback mtight">до</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><!----></span><!--]--><!----> — изменение потенциала.<!----></p><!----> <p class="svelte-xyzgp3"><!---->То есть, при каждом рекурсивном вызове мы поднимаем одно из сливаемых деревьев по правому пути,
    но после операции <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->merge<!----></code><!----></span><!----> все узлы на этом пути становятся левыми потомками, что <b>уменьшает потенциал</b>.
    Выражаясь формально <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">Φ</mi><mo>⩽</mo><mo>−</mo><mi>t</mi><mo>+</mo><mn>2</mn><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\Delta\Phi \le -t + 2 \log n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.82em;vertical-align:-0.1367em;"></span><span class="mord">ΔΦ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6984em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span></span></span></span><!----></span><!--]--><!----> .<!----></p><!----> <p class="svelte-xyzgp3"><!---->Подставим в формулу амортизирвоанной сложности и получим:<!----></p><!----> <!--[--><div class="math-display svelte-16qk674"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>c</mi><mo>^</mo></mover><mo>=</mo><mi>t</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">Φ</mi><mo>⩽</mo><mi>t</mi><mo>+</mo><mo stretchy="false">(</mo><mo>−</mo><mi>t</mi><mo>+</mo><mn>2</mn><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mi>log</mi><mo>⁡</mo><mi>n</mi><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\hat{c} = t + \Delta\Phi \le t + (-t + 2 \log n) = 2 \log n = O(\log n).</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">c</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6984em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.82em;vertical-align:-0.1367em;"></span><span class="mord">ΔΦ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6984em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span><!----></div><!--]--><!----><!----></div><!----></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Таким образом, хотя отдельные вызовы могут быть дорогими, путем постоянного хаотичного пермешивания кучи
    мы смогли добиться сложности <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!---->,
    при этом сохранив память не сохраняя <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">dist</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\dist(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">dist</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!----> в каждом узле.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Отсюда следует нехитрый вывод: если нам критически важно поведение структуры данных в worst-case ситуации,
    то стоит прибегать к реализации левосторонней кучи, а если количество операций с кучей
    большое и нам важно сохранить память, то скошенная куча будет эффективнее.<!----></p><!----><!----></div><!----> <h1 class="svelte-mdj34r"><!---->Задачи<!----></h1><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><b>1.</b> Почему в скошенной куче нельзя заменить <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">swap</span> x<span class="punctuation">.</span>left<span class="punctuation">,</span> x<span class="punctuation">.</span>right<!----></code><!----></span><!----> на <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">swap</span> x<span class="punctuation">.</span>right<span class="punctuation">,</span> x<span class="punctuation">.</span>left<!----></code><!----></span><!----> в коде слияния? Что изменится?<!----></p><!----> <p class="svelte-xyzgp3"><b>2.</b> Пусть в левосторонней куче узел <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><!----></span><!--]--><!----> имеет <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">dist</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">\dist(v) = k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">dist</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span><!----></span><!--]--><!----> . Какое минимальное количество узлов должно быть в поддереве с корнем <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><!----></span><!--]--><!---->?<!----></p><!----> <p class="svelte-xyzgp3"><b>3.</b> Реализуйте скошенную кучу и функции для нее.<!----></p><!----> <p class="svelte-xyzgp3"><b>4.</b> Реализуйте правостороннюю кучу и функции для нее.<!----></p><!----><!----></div><!----><!----><!----></article> <div class="svelte-1cvbhgs"></div><!----><!--]--><!----></main><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_1h7j5ru = {
						base: new URL("../..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../../_app/immutable/entry/start.Dkklk6Rf.js"),
						import("../../_app/immutable/entry/app.Bva7xl9u.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2, 135],
							data: [null,null,null],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
</body>
</html>
