<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <link rel="icon" href="../../favicon.svg"/>
    <link rel="stylesheet" href="../../fonts/Inter/inter.css"/>
    <link rel="stylesheet" href="../../fonts/JetBrainsMono/jetbrainsmono.css"/>
    <link rel="stylesheet" href="../../variables.css"/>
    <link rel="stylesheet" href="../../global.css"/>
    <link rel="stylesheet" href="../../katex.css"/>

    <link rel="stylesheet" media="print" href="../../print.css">

    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    
		<link href="../../_app/immutable/assets/Link.Cb7NHG_N.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Button.DCPIk07g.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Icon.D0g2C4hd.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/0.ieOoEAmI.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/2.DXAScjb8.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Title.DPHn_YVg.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Par.K_845M5t.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/P.BQjmqsBn.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Math.oZcZgltA.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/InternalCode.18_KRbfN.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Codeblock.CTVfIT4f.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Heading.B4n5dO8q.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Subheading.Sazqxtg1.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Code.DJ30TqtG.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Image.4MnJTrhn.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/Proof.BeOUDyan.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/EnumList.CtnWplwG.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/ListItem.BKpMqDLa.css" rel="stylesheet">
		<link rel="modulepreload" href="../../_app/immutable/entry/start.Dkklk6Rf.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DsAObCLR.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/O64VAD6H.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BWp35gWV.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DIeogL5L.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/CNky9LEp.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/HEAPfHvV.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DkB2Co80.js">
		<link rel="modulepreload" href="../../_app/immutable/entry/app.Bva7xl9u.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/CWj6FrbW.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BOcoFmK4.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/MBbrtcMh.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/D-GYhs9T.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/0.LPgsIMBt.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/C9z9AdnA.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DDpIWRRY.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DlH7fH6r.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DvKvArtv.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DPocoKFO.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/UpSqMDag.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/69_IOA4Y.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/2.Di9RQfus.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/118.D9vg7JxM.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/CR7k0xtG.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DPzc5wQr.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/B7flgP-x.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BqyEoRxA.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DAvg0_9P.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/C2dv2nOL.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BvAJckrt.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/CpJhWio5.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/i9XClpbl.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/DXKx2xvL.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/CBbFRhrb.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BmgYHZay.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/Cv_jjTLk.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/BBkyo9uE.js"><!--[--><!--]--><!--[--><!--]--><title>AVL дерево</title>
</head>
<body data-sveltekit-preload-data="hover">
<div style="display: contents"><!--[--><!--[--><!----><header class="svelte-9v5dz7"><img src="/favicon.svg" alt="" role="presentation" class="svelte-9v5dz7"/> <button type="button" id="mobile-menu-button" class="subtle svelte-apk4jo"><!--[!--><svg viewBox="0 0 48 48" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="svelte-1tf3wrl" style="height: 1.5rem; margin: 0rem;"><path d="M40 12L8 12" stroke="currentColor" stroke-width="6" stroke-linecap="round"></path><path d="M40 24L8 24" stroke="currentColor" stroke-width="6" stroke-linecap="round"></path><path d="M40 36L8 36" stroke="currentColor" stroke-width="6" stroke-linecap="round"></path><!----></svg><!----> Меню<!----><!--]--></button><!----> <!--[--><nav class="svelte-9v5dz7"><!--[--><a href="/knowledge" class="svelte-1txvory colorless"><!---->База знаний<!----></a><a href="/scenario" class="svelte-1txvory colorless"><!---->Сценарий<!----></a><a href="/tasks" class="svelte-1txvory colorless"><!---->Задания<!----></a><a href="/rules" class="svelte-1txvory colorless"><!---->Правила игры<!----></a><!--]--></nav><!--]--></header> <!--[!--><!--]--><!----><!----> <main><!--[--><!----><article class="svelte-1cvbhgs"><!----><div class="title svelte-uw1xhm"><!--[!--><h1 class="svelte-uw1xhm">AVL дерево</h1><!--]--></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Все проблемы несбалансированных деревьев из-за высоты. Точнее, из-за большой разности высот поддеревьев.
    Давайте на основе этой разности введем фактор балансировки.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Для каждой узла <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><!----></span><!--]--><!----> определим <b>height balance factor (фактор балансировки)</b> —
    разницу высот правого и левого поддеревьев.<!----></p><!----> <!--[--><div class="math-display svelte-16qk674"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">bf</mi><mo>⁡</mo><mi>v</mi><mo>=</mo><mi mathvariant="normal">height</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>v</mi><mi mathvariant="normal">.</mi><mtext>left</mtext><mo stretchy="false">)</mo><mo>−</mo><mi mathvariant="normal">height</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>v</mi><mi mathvariant="normal">.</mi><mtext>right</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\bf v = \height(v.\code{left}) - \height(v.\code{right})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mop"><span class="mord mathrm" style="margin-right:0.07778em;">bf</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">height</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">.</span><span class="enclosing code"><span class="mord text"><span class="mord">left</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">height</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">.</span><span class="enclosing code"><span class="mord text"><span class="mord">right</span></span></span><span class="mclose">)</span></span></span></span></span><!----></div><!--]--><!----> <p class="svelte-xyzgp3"><!---->Если фактор балансировки у каких-то узлов по модулю большой, то это значит наше дерево перекашивает,
    и высота дерева становится неприемлемой.
    Нам нужно, чтобы этот фактор балансировки был небольшим для всех узлов дерева.
    Тогда само дерево будет больше похоже на полное дерево, а не на бамбук.<!----></p><!----><!----></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Давайте возьмём наименьшее из возможных требований для фактора балансировки.
    Потребуем, чтобы у всех узлов нашего дерева фактор балансировки по модулю не превосходил <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->.<!----></p><!----> <!--[--><div class="math-display svelte-16qk674"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">bf</mi><mo>⁡</mo><mi>v</mi><mi mathvariant="normal">∣</mi><mo>⩽</mo><mn>1</mn><mspace width="1em"/><mtext>для всех узлов </mtext><mi>v</mi></mrow><annotation encoding="application/x-tex">|\bf v| \le 1 \quad\text{для всех узлов}~ v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm" style="margin-right:0.07778em;">bf</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord cyrillic_fallback">для</span><span class="mord"> </span><span class="mord cyrillic_fallback">всех</span><span class="mord"> </span><span class="mord cyrillic_fallback">узлов</span></span><span class="mspace nobreak"> </span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></span><!----></div><!--]--><!----> <p class="svelte-xyzgp3"><!---->Это требование, как мы убедимся дальше, очень легко поддерживать.
    В 1962 году советские математики Георгий Максимович Адельсон-Вельский и Евгений Михайлович Ландис
    описали такой метод балансировки деревьев.
    Самобалансирующиеся деревья, которые мы с вами дальше будем строить и изучать, носят их имя — <b>AVL-деревья</b>.<!----></p><!----><!----></div><!----> <h1 class="svelte-1trpu2y"><!---->Структура AVL дерева<!----></h1><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Узел AVL-дерева содержит те же поля, что и узел обычного бинарного дерева поиска,
    плюс дополнительное поле <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->balance<!----></code><!----></span><!----> для хранения своего фактора балансировки.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Также, для нормальной реализации всех алгоритмов без рекурсии, добавим поле <span class="code svelte-1kfz46x"><code class="language-pseudocode svelte-127l4oe"><!---->parent<!----></code><!----></span><!---->,
    которое будет хранить ссылку на родителя узла.<!----></p><!----><!----></div><!----> <div class="codeblock svelte-in28rj"><div class="overflow-box svelte-in28rj"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">struct</span> <span class="class-name">node</span><span class="punctuation">:</span>
    <span class="property">ref</span> <span class="class-name">node</span> left
    <span class="property">ref</span> <span class="class-name">node</span> right
    <span class="property">ref</span> <span class="class-name">node</span> parent
    <span class="builtin">int</span> balance

    <span class="builtin">key</span> <span class="builtin">key</span>
    <span class="comment">some additional data</span><!----></code><!----></div></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Можно, конечно, в узле хранить высоту его поддерева.
    Но если мы храним фактор балансировки, который может принимать только значения <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span><!----></span><!--]--><!---->, <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!----> и <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->,
    то мы дополнительно тратим всего <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span><!----></span><!--]--><!----> бита вместо полного числа.<!----></p><!----></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Итак, после операции вставки или удаления узла дерево может перестать быть сбалансированным,
    то есть у какой-то узла <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">bf</mi><mo>⁡</mo><mi>v</mi><mi mathvariant="normal">∣</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|\bf v| &gt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm" style="margin-right:0.07778em;">bf</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->. Надо научиться возвращать дереву баланс.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Ключевое свойство, которое делает AVL-деревья эффективными: после вставки или удалении узла фактор балансировки
    может измениться только тех у узлов, которые лежат на пути от корня до вставленного или удаленного узла.
    И изменяется фактор балансировки на <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!----> или на <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->.
    То есть это значит, что для восстановления баланса нам достаточно подняться от изменённого узла к корню,
    на каждом уровне проверить и при необходимости исправить баланс.
    Остановимся мы тогда, когда баланс перестанет меняться.<!----></p><!----><!----></div><!----> <h1 class="svelte-1trpu2y"><!---->Повороты и восстановление баланса<!----></h1><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Иногда так случается, что для какого-то узла <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><!----></span><!--]--><!----> перестаёт
    выполняться свойство <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">bf</mi><mo>⁡</mo><mi>v</mi><mi mathvariant="normal">∣</mi><mo>⩽</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|\bf v| \le 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm" style="margin-right:0.07778em;">bf</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->.
    Нужно это свойство восстанавливать.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Если у узла <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><!----></span><!--]--><!----> случилась разбалансировка, то обязательно <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">bf</mi><mo>⁡</mo><mi>v</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">|\bf v| = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm" style="margin-right:0.07778em;">bf</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span><!----></span><!--]--><!---->.
    Связано это с тем, что у AVL-дерева всегда <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">bf</mi><mo>⁡</mo><mi>v</mi><mi mathvariant="normal">∣</mi><mo>⩽</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|\bf v| \le 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm" style="margin-right:0.07778em;">bf</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->,
    а модифицирующие операции (вставка узла и удаление узла)
    могут изменить фактор балансировки максимум на <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Для восстановления баланса узла нам нужно немного изменить структуру дерева.
    Это можно сделать с помощью операций, называемых <b>поворотами</b>.
    Повороты — это <b>локальные</b> перестройки дерева,
    которые изменяют относительные высоты поддеревьев определённого узла, сохраняя при этом порядок ключей,
    то есть свойство бинарного дерева поиска остаётся выполненным:
    ключи в левом поддереве узла после поворота остаются меньше ключа этого узла,
    и ключи в правом поддереве узла после поворота остаются больше ключа этого узла.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Повороты происходят относительно узла с нарушенным балансом и затрагивают только его детей и внуков —
    всего <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!----> узлов.
    При этом высота всего его поддерева обычно уменьшается на <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->,
    что помогает восстановить баланс у родительских узлов при подъёме от изменённого узла к корню.<!----></p><!----><!----></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><b>Обычные повороты.</b><!----></p><!----> <p class="svelte-xyzgp3"><!---->Если знаки у факторов балансировки узла и его ребёнка одинаковые,
    то есть если направления разбалансировки совпадают,
    то нам достаточно просто совершить самый обычный поворот:
    ребёнок с перевешивающей стороны становится новым корнем поддерева,
    а разбалансированный узел сползает на место второго ребёнка.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Если фактор балансировки узла равен <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span><!----></span><!--]--><!---->,
    а у его левого ребёнка фактор балансировки равен <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->,
    то нужно выполнить правый поворот (на рисунке стрелка вправо).<!----></p><!----> <p class="svelte-xyzgp3"><!---->Аналогично, если фактор балансировки узла равен <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">-2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">2</span></span></span></span><!----></span><!--]--><!---->,
    а у его правого ребёнка фактор балансировки равен <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->,
    то нужно выполнить левый поворот (на рисунке стрелка влево).
    Результат симметричен результату правого поворота.<!----></p><!----><!----></div><!----> <figure class="svelte-1uuxmnb"><div class="wrapper"><img src="/_app/immutable/assets/rotate.CB3UqdHU.svg" alt="" role="presentation" loading="lazy" class="svelte-1uuxmnb"/></div> <!--[!--><!--]--></figure><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><b>Большие повороты.</b><!----></p><!----> <p class="svelte-xyzgp3"><!---->Если знаки у факторов балансировки узла и его ребёнка разные,
    то есть если направления разбалансировки не совпадают,
    то после обычного поворота узла дерево снова будет разбалансированным, но уже в другую сторону.
    Для того, чтобы исправлять такие ситуации, нам нужно совершать не один, а два поворота.
    Такой двойной поворот называется <b>большим поворотом</b>.<!----></p><!----><!----></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Большой правый поворот совершается, если поддерево разбалансировано влево,
    то есть если фактор балансировки у узла <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span><!----></span><!--]--><!---->,
    а фактор балансировки у левого ребёнка узла равен <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->.<!----></p><!----></div><!----> <figure class="svelte-1uuxmnb"><div class="wrapper"><img src="/_app/immutable/assets/big-rotate-right.DHV2BuZt.svg" alt="" role="presentation" loading="lazy" class="svelte-1uuxmnb"/></div> <!--[--><figcaption class="svelte-1uuxmnb"><!---->Большой правый поворот<!----></figcaption><!--]--></figure><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Большой левый поворот совершается, если поддерево разбалансировано вправо,
    то есть если фактор балансировки у узла <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">-2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">2</span></span></span></span><!----></span><!--]--><!---->,
    а фактор балансировки у правого ребёнка узла равен <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->.<!----></p><!----></div><!----> <figure class="svelte-1uuxmnb"><div class="wrapper"><img src="/_app/immutable/assets/big-rotate-left.D5h7hwUi.svg" alt="" role="presentation" loading="lazy" class="svelte-1uuxmnb"/></div> <!--[--><figcaption class="svelte-1uuxmnb"><!---->Большой левый поворот<!----></figcaption><!--]--></figure><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->После поворота нам нужно пересчитать фактор балансировки затронутых узлов.
    Важно, что операция поворота локальная, поэтому мы не поднимаемся выше,
    хотя фактически фактор балансировки мог измениться у всех узлов, чьи поддеревья мы затронули в процессе поворота.
    Подниматься наверх мы будем при исполнении модифицирующих операций.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Для удобства и чистоты реализации функции поворота должны возвращать новый корень поддерева.<!----></p><!----><!----></div><!----> <div class="codeblock svelte-in28rj"><div class="overflow-box svelte-in28rj"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">function</span> <span class="function">rotate_right</span><span class="punctuation">(</span><span class="property">ref</span> <span class="class-name">node</span> a<span class="punctuation">)</span> <span class="operator">-</span><span class="operator">&gt;</span> <span class="property">ref</span> <span class="class-name">node</span><span class="punctuation">:</span>
    <span class="property">ref</span> <span class="class-name">node</span> b <span class="operator">=</span> a<span class="punctuation">.</span>left

    <span class="keyword">assert</span> a<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="number">2</span>
    <span class="keyword">assert</span> b<span class="punctuation">.</span>balance <span class="operator">&gt;=</span> <span class="number">0</span>

    a<span class="punctuation">.</span>left <span class="operator">=</span> b<span class="punctuation">.</span>right

    <span class="keyword">if</span> b<span class="punctuation">.</span>right <span class="keyword">is</span> <span class="keyword">not</span> <span class="boolean">null</span><span class="punctuation">:</span>
        b<span class="punctuation">.</span>right<span class="punctuation">.</span>parent <span class="operator">=</span> a

    b<span class="punctuation">.</span>right <span class="operator">=</span> a
    b<span class="punctuation">.</span>parent <span class="operator">=</span> a<span class="punctuation">.</span>parent
    a<span class="punctuation">.</span>parent <span class="operator">=</span> b

    <span class="keyword">if</span> b<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="number">1</span><span class="punctuation">:</span>
        a<span class="punctuation">.</span>balance <span class="operator">=</span> <span class="number">0</span>
        b<span class="punctuation">.</span>balance <span class="operator">=</span> <span class="number">0</span>

    <span class="keyword">else</span> <span class="keyword">if</span> b<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="number">0</span><span class="punctuation">:</span>
        a<span class="punctuation">.</span>balance <span class="operator">=</span> <span class="number">1</span>
        b<span class="punctuation">.</span>balance <span class="operator">=</span> <span class="operator">-</span><span class="number">1</span>

    <span class="keyword">return</span> b<!----></code><!----></div></div><!----> <div class="codeblock svelte-in28rj"><div class="overflow-box svelte-in28rj"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">function</span> <span class="function">rotate_left</span><span class="punctuation">(</span><span class="property">ref</span> <span class="class-name">node</span> a<span class="punctuation">)</span> <span class="operator">-</span><span class="operator">&gt;</span> <span class="property">ref</span> <span class="class-name">node</span><span class="punctuation">:</span>
    <span class="property">ref</span> <span class="class-name">node</span> b <span class="operator">=</span> a<span class="punctuation">.</span>right

    <span class="keyword">assert</span> a<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="operator">-</span><span class="number">2</span>
    <span class="keyword">assert</span> b<span class="punctuation">.</span>balance <span class="operator">&lt;=</span> <span class="number">0</span>

    a<span class="punctuation">.</span>right <span class="operator">=</span> b<span class="punctuation">.</span>left

    <span class="keyword">if</span> b<span class="punctuation">.</span>left <span class="keyword">is</span> <span class="keyword">not</span> <span class="boolean">null</span><span class="punctuation">:</span>
        b<span class="punctuation">.</span>left<span class="punctuation">.</span>parent <span class="operator">=</span> a

    b<span class="punctuation">.</span>left <span class="operator">=</span> a
    b<span class="punctuation">.</span>parent <span class="operator">=</span> a<span class="punctuation">.</span>parent
    a<span class="punctuation">.</span>parent <span class="operator">=</span> b

    <span class="keyword">if</span> b<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">:</span>
        a<span class="punctuation">.</span>balance <span class="operator">=</span> <span class="number">0</span>
        b<span class="punctuation">.</span>balance <span class="operator">=</span> <span class="number">0</span>

    <span class="keyword">else</span> <span class="keyword">if</span> b<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="number">0</span><span class="punctuation">:</span>
        a<span class="punctuation">.</span>balance <span class="operator">=</span> <span class="operator">-</span><span class="number">1</span>
        b<span class="punctuation">.</span>balance <span class="operator">=</span> <span class="number">1</span>

    <span class="keyword">return</span> b<!----></code><!----></div></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Большие повороты можно явно реализовать по картинке, но, чтобы не мучаться с пересчётом
    факторов балансировки у вершин, можно реализовать каждый большой поворот через два обычных.<!----></p><!----></div><!----> <div class="codeblock svelte-in28rj"><div class="overflow-box svelte-in28rj"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">function</span> <span class="function">big_rotate_left</span><span class="punctuation">(</span><span class="property">ref</span> <span class="class-name">node</span> a<span class="punctuation">)</span> <span class="operator">-</span><span class="operator">&gt;</span> <span class="property">ref</span> <span class="class-name">node</span><span class="punctuation">:</span>
    <span class="property">ref</span> <span class="class-name">node</span> b <span class="operator">=</span> a<span class="punctuation">.</span>right

    <span class="keyword">assert</span> a<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="operator">-</span><span class="number">2</span>
    <span class="keyword">assert</span> b<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="number">1</span>

    a<span class="punctuation">.</span>right <span class="operator">=</span> <span class="function">rotate_right</span><span class="punctuation">(</span>b<span class="punctuation">)</span>  <span class="comment"># правый поворот вокруг b</span>
    <span class="keyword">return</span> <span class="function">rotate_left</span><span class="punctuation">(</span>a<span class="punctuation">)</span>      <span class="comment"># левый поворот вокруг a</span><!----></code><!----></div></div><!----> <div class="codeblock svelte-in28rj"><div class="overflow-box svelte-in28rj"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">function</span> <span class="function">big_rotate_right</span><span class="punctuation">(</span><span class="property">ref</span> <span class="class-name">node</span> a<span class="punctuation">)</span> <span class="operator">-</span><span class="operator">&gt;</span> <span class="property">ref</span> <span class="class-name">node</span><span class="punctuation">:</span>
    <span class="property">ref</span> <span class="class-name">node</span> b <span class="operator">=</span> a<span class="punctuation">.</span>left

    <span class="keyword">assert</span> a<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="number">2</span>
    <span class="keyword">assert</span> b<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="operator">-</span><span class="number">1</span>

    a<span class="punctuation">.</span>left <span class="operator">=</span> <span class="function">rotate_left</span><span class="punctuation">(</span>b<span class="punctuation">)</span>  <span class="comment"># левый поворот вокруг b</span>
    <span class="keyword">return</span> <span class="function">rotate_right</span><span class="punctuation">(</span>a<span class="punctuation">)</span>   <span class="comment"># правый поворот вокруг a</span><!----></code><!----></div></div><!----> <h1 class="svelte-1trpu2y"><!---->Вставка в AVL-дерево<!----></h1><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Пусть нам надо добавить в дерево узел с ключом <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span><!----></span><!--]--><!---->.
    Будем спускаться по дереву как при поиске ключа <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span><!----></span><!--]--><!---->.
    Если мы стоим в узле <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><!----></span><!--]--><!----> и нам надо спуститься в поддерево, которого нет,
    то делаем новый узел листом, и узел <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><!----></span><!--]--><!----> его корнем.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Далее нам нужно подниматься вверх до корня, пересчитывая фактор балансировки у вершин и выполняя повороты.
    Если мы поднялись в вершину <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span><!----></span><!--]--><!----> из левого поддерева,
    то <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi mathvariant="normal">.</mi><mtext>balance</mtext></mrow><annotation encoding="application/x-tex">w.\code{balance}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord">.</span><span class="enclosing code"><span class="mord text"><span class="mord">balance</span></span></span></span></span></span><!----></span><!--]--><!----> увеличивается на <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->,
    а если из правого поддерева, то <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi mathvariant="normal">.</mi><mtext>balance</mtext></mrow><annotation encoding="application/x-tex">w.\code{balance}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord">.</span><span class="enclosing code"><span class="mord text"><span class="mord">balance</span></span></span></span></span></span><!----></span><!--]--><!----> уменьшается на <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->.<!----></p><!----> <p class="svelte-xyzgp3"><!---->После пересчёта фактора балансировки надо понять, что делать дальше.
    Если он равен <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!----> или <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->, то мы продолжаем подниматься.
    Если он равен <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span><!----></span><!--]--><!---->, то высота поддерева не изменилась, а значит можно заканчивать пересчёт.
    Если он оказался равным <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span><!----></span><!--]--><!----> или <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">-2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">2</span></span></span></span><!----></span><!--]--><!---->, делаем нужный поворот
    и снова смотрим на фактор балансировки нового корня поддерева.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Для каждого узла на пути от листа до корня мы сделаем не более одного поворота,
    и в любом случае будем подниматься вверх. Значит, на пересчёт факторов балансировки и на восстановление баланса
    мы потратим время <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mtext>высота дерева</mtext><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\text{высота дерева}) = O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord text"><span class="mord cyrillic_fallback">высота</span><span class="mord"> </span><span class="mord cyrillic_fallback">дерева</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!---->, а точнее ...<!----></p><!----><!----></div><!----> <div class="codeblock svelte-in28rj"><div class="overflow-box svelte-in28rj"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">function</span> <span class="function">new_node</span><span class="punctuation">(</span><span class="builtin">key</span> t<span class="punctuation">)</span> <span class="operator">-</span><span class="operator">&gt;</span> <span class="property">ref</span> <span class="class-name">node</span><span class="punctuation">:</span>
    <span class="keyword">return</span> <span class="keyword">new</span> <span class="class-name">node</span> <span class="operator">=</span> <span class="punctuation">{</span>
        left <span class="operator">=</span> <span class="boolean">null</span><span class="punctuation">,</span>
        right <span class="operator">=</span> <span class="boolean">null</span><span class="punctuation">,</span>
        parent <span class="operator">=</span> <span class="boolean">null</span><span class="punctuation">,</span>
        balance <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span>
        <span class="builtin">key</span> <span class="operator">=</span> t
    <span class="punctuation">}</span>

<span class="keyword">function</span> <span class="function">insert</span><span class="punctuation">(</span><span class="property">ref</span> <span class="class-name">node</span> root<span class="punctuation">,</span> <span class="builtin">key</span> t<span class="punctuation">)</span> <span class="operator">-</span><span class="operator">&gt;</span> <span class="property">ref</span> <span class="class-name">node</span><span class="punctuation">:</span>
    <span class="keyword">if</span> root <span class="operator">==</span> <span class="boolean">null</span><span class="punctuation">:</span>
        <span class="keyword">return</span> <span class="function">new_node</span><span class="punctuation">(</span>t<span class="punctuation">)</span>

    current <span class="operator">=</span> root
    <span class="keyword">while</span> current <span class="keyword">is</span> <span class="keyword">not</span> <span class="boolean">null</span><span class="punctuation">:</span>
        <span class="keyword">if</span> t <span class="operator">&lt;</span> current<span class="punctuation">.</span><span class="builtin">key</span><span class="punctuation">:</span>
            <span class="keyword">if</span> current<span class="punctuation">.</span>left <span class="operator">==</span> <span class="boolean">null</span><span class="punctuation">:</span>
                current<span class="punctuation">.</span>left <span class="operator">=</span> <span class="function">new_node</span><span class="punctuation">(</span>t<span class="punctuation">)</span>
                current<span class="punctuation">.</span>left<span class="punctuation">.</span>parent <span class="operator">=</span> current
                current <span class="operator">=</span> current<span class="punctuation">.</span>left
                <span class="keyword">break</span>
            current <span class="operator">=</span> current<span class="punctuation">.</span>left

        <span class="keyword">else</span> <span class="keyword">if</span> t <span class="operator">&gt;</span> current<span class="punctuation">.</span><span class="builtin">key</span><span class="punctuation">:</span>
            <span class="keyword">if</span> current<span class="punctuation">.</span>right <span class="operator">==</span> <span class="boolean">null</span><span class="punctuation">:</span>
                current<span class="punctuation">.</span>right <span class="operator">=</span> <span class="function">new_node</span><span class="punctuation">(</span>t<span class="punctuation">)</span>
                current<span class="punctuation">.</span>right<span class="punctuation">.</span>parent <span class="operator">=</span> current
                current <span class="operator">=</span> current<span class="punctuation">.</span>right
                <span class="keyword">break</span>
            current <span class="operator">=</span> current<span class="punctuation">.</span>right

        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="keyword">return</span> root  <span class="comment"># ключ уже существует</span>

    <span class="comment"># Поднимаемся вверх и балансируем</span>
    <span class="keyword">while</span> current <span class="keyword">is</span> <span class="keyword">not</span> <span class="boolean">null</span><span class="punctuation">:</span>
        parent <span class="operator">=</span> current<span class="punctuation">.</span>parent

        <span class="keyword">if</span> parent <span class="keyword">is</span> <span class="keyword">not</span> <span class="boolean">null</span><span class="punctuation">:</span>  <span class="comment"># Если есть родитель, обновляем его баланс</span>
            <span class="keyword">if</span> current <span class="operator">==</span> parent<span class="punctuation">.</span>left<span class="punctuation">:</span>
                parent<span class="punctuation">.</span>balance <span class="operator">+=</span> <span class="number">1</span>
            <span class="keyword">else</span><span class="punctuation">:</span>
                parent<span class="punctuation">.</span>balance <span class="operator">-=</span> <span class="number">1</span>

            <span class="keyword">if</span> parent<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="number">0</span><span class="punctuation">:</span> <span class="comment"># высота не изменилась</span>
                <span class="keyword">break</span>

            <span class="keyword">else</span> <span class="keyword">if</span> parent<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="number">1</span> <span class="keyword">or</span> parent<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">:</span>  <span class="comment"># продолжаем подъем</span>
                current <span class="operator">=</span> parent
                <span class="keyword">continue</span>

            <span class="keyword">else</span> <span class="keyword">if</span> parent<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="number">2</span><span class="punctuation">:</span>  <span class="comment"># нарушен баланс влево</span>
                <span class="keyword">if</span> parent<span class="punctuation">.</span>left<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="number">1</span><span class="punctuation">:</span>
                    new_root <span class="operator">=</span> <span class="function">rotate_right</span><span class="punctuation">(</span>parent<span class="punctuation">)</span>
                <span class="keyword">else</span><span class="punctuation">:</span>
                    new_root <span class="operator">=</span> <span class="function">big_rotate_right</span><span class="punctuation">(</span>parent<span class="punctuation">)</span>

            <span class="keyword">else</span> <span class="keyword">if</span> parent<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="operator">-</span><span class="number">2</span><span class="punctuation">:</span>  <span class="comment"># нарушен баланс вправо</span>
                <span class="keyword">if</span> parent<span class="punctuation">.</span>right<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">:</span>
                    new_root <span class="operator">=</span> <span class="function">rotate_left</span><span class="punctuation">(</span>parent<span class="punctuation">)</span>
                <span class="keyword">else</span><span class="punctuation">:</span>
                    new_root <span class="operator">=</span> <span class="function">big_rotate_left</span><span class="punctuation">(</span>parent<span class="punctuation">)</span>

            <span class="comment"># Обновляем ссылку у дедушки</span>
            grandparent <span class="operator">=</span> parent<span class="punctuation">.</span>parent
            <span class="keyword">if</span> grandparent <span class="keyword">is</span> <span class="keyword">not</span> <span class="boolean">null</span><span class="punctuation">:</span>
                <span class="keyword">if</span> grandparent<span class="punctuation">.</span>left <span class="operator">==</span> parent<span class="punctuation">:</span>
                    grandparent<span class="punctuation">.</span>left <span class="operator">=</span> new_root
                <span class="keyword">else</span><span class="punctuation">:</span>
                    grandparent<span class="punctuation">.</span>right <span class="operator">=</span> new_root
            <span class="keyword">else</span><span class="punctuation">:</span>
                root <span class="operator">=</span> new_root  <span class="comment"># обновили корень дерева</span>

            <span class="comment"># Решаем, продолжать ли подъем</span>
            <span class="keyword">if</span> new_root<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="number">0</span><span class="punctuation">:</span>
                <span class="keyword">break</span>
            <span class="keyword">else</span><span class="punctuation">:</span>
                current <span class="operator">=</span> new_root

        <span class="keyword">else</span><span class="punctuation">:</span>  <span class="comment"># current - корень, проверяем его баланс</span>
            <span class="keyword">if</span> current<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="number">2</span><span class="punctuation">:</span>
                <span class="keyword">if</span> current<span class="punctuation">.</span>left<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="number">1</span><span class="punctuation">:</span>
                    root <span class="operator">=</span> <span class="function">rotate_right</span><span class="punctuation">(</span>current<span class="punctuation">)</span>
                <span class="keyword">else</span><span class="punctuation">:</span>
                    root <span class="operator">=</span> <span class="function">big_rotate_right</span><span class="punctuation">(</span>current<span class="punctuation">)</span>

            <span class="keyword">else</span> <span class="keyword">if</span> current<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="operator">-</span><span class="number">2</span><span class="punctuation">:</span>
                <span class="keyword">if</span> current<span class="punctuation">.</span>right<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">:</span>
                    root <span class="operator">=</span> <span class="function">rotate_left</span><span class="punctuation">(</span>current<span class="punctuation">)</span>
                <span class="keyword">else</span><span class="punctuation">:</span>
                    root <span class="operator">=</span> <span class="function">big_rotate_left</span><span class="punctuation">(</span>current<span class="punctuation">)</span>

            <span class="keyword">break</span>

    <span class="keyword">return</span> root<!----></code><!----></div></div><!----> <h1 class="svelte-1trpu2y"><!---->Удаление вершины<!----></h1><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Если удаляемый узел <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span><!----></span><!--]--><!----> является листом, то удалим его.
    Если у него есть дети, то найдем ему замену <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><!----></span><!--]--><!----> —
    узел с наименьшим ключом в правом поддереве удаляемого узла <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span><!----></span><!--]--><!---->,
    или узел с наибольшим ключом в левом поддереве удаляемого узла <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span><!----></span><!--]--><!---->.
    Скопируем данные из <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><!----></span><!--]--><!----> в <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span><!----></span><!--]--><!----> и удалим уже узел <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span><!----></span><!--]--><!---->.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Далее нам нужно подниматься вверх от родителя фактически удалённого узла до корня,
    пересчитывая фактор балансировки у вершин и выполняя повороты.
    Если мы поднялись в вершину <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span><!----></span><!--]--><!----> из левого поддерева,
    то <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi mathvariant="normal">.</mi><mtext>balance</mtext></mrow><annotation encoding="application/x-tex">w.\code{balance}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord">.</span><span class="enclosing code"><span class="mord text"><span class="mord">balance</span></span></span></span></span></span><!----></span><!--]--><!----> уменьшается на <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->,
    а если из правого поддерева, то <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi mathvariant="normal">.</mi><mtext>balance</mtext></mrow><annotation encoding="application/x-tex">w.\code{balance}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord">.</span><span class="enclosing code"><span class="mord text"><span class="mord">balance</span></span></span></span></span></span><!----></span><!--]--><!----> увеличивается на <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->.<!----></p><!----> <p class="svelte-xyzgp3"><!---->После пересчёта фактора балансировки надо понять, что делать дальше.
    Если он равен <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span><!----></span><!--]--><!---->, то высота поддерева уменьшилась, и мы продолжаем подниматься.
    Если он равен <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!----> или <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span><!----></span><!--]--><!---->, то высота поддерева не изменилась,
    а значит можно заканчивать пересчёт.
    Если он оказался равным <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span><!----></span><!--]--><!----> или <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">-2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">2</span></span></span></span><!----></span><!--]--><!---->, делаем нужный поворот
    и снова смотрим на фактор балансировки нового корня поддерева.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Для каждого узла на пути от листа до корня мы сделаем не более одного поворота,
    и в любом случае будем подниматься вверх. Значит, на пересчёт факторов балансировки и на восстановление баланса
    мы потратим время <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mtext>высота дерева</mtext><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\text{высота дерева}) = O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord text"><span class="mord cyrillic_fallback">высота</span><span class="mord"> </span><span class="mord cyrillic_fallback">дерева</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!---->, а точнее ...<!----></p><!----><!----></div><!----> <div class="codeblock svelte-in28rj"><div class="overflow-box svelte-in28rj"><code class="language-pseudocode svelte-127l4oe"><!----><span class="keyword">function</span> <span class="keyword">delete</span><span class="punctuation">(</span><span class="property">ref</span> <span class="class-name">node</span> root<span class="punctuation">,</span> <span class="builtin">key</span> t<span class="punctuation">)</span><span class="punctuation">:</span>
    <span class="keyword">if</span> root <span class="operator">==</span> <span class="boolean">null</span><span class="punctuation">:</span>
        <span class="keyword">return</span>

    <span class="comment"># Поиск удаляемого узла</span>
    current <span class="operator">=</span> root
    <span class="keyword">while</span> current <span class="keyword">is</span> <span class="keyword">not</span> <span class="boolean">null</span><span class="punctuation">:</span>
        <span class="keyword">if</span> t <span class="operator">&lt;</span> current<span class="punctuation">.</span><span class="builtin">key</span><span class="punctuation">:</span>
            current <span class="operator">=</span> current<span class="punctuation">.</span>left
        <span class="keyword">else</span> <span class="keyword">if</span> t <span class="operator">&gt;</span> current<span class="punctuation">.</span><span class="builtin">key</span><span class="punctuation">:</span>
            current <span class="operator">=</span> current<span class="punctuation">.</span>right
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="keyword">break</span>  <span class="comment"># нашли узел для удаления</span>

    <span class="keyword">if</span> current <span class="operator">==</span> <span class="boolean">null</span><span class="punctuation">:</span>
        throw error  <span class="comment"># узел не найден</span>

    start_balance_from <span class="operator">=</span> <span class="boolean">null</span>  <span class="comment"># откуда начинать балансировку</span>

    <span class="keyword">if</span> current<span class="punctuation">.</span>left <span class="operator">==</span> <span class="boolean">null</span> <span class="keyword">and</span> current<span class="punctuation">.</span>right <span class="operator">==</span> <span class="boolean">null</span><span class="punctuation">:</span>  <span class="comment"># узел - лист</span>
        <span class="keyword">if</span> current<span class="punctuation">.</span>parent <span class="keyword">is</span> <span class="keyword">not</span> <span class="boolean">null</span><span class="punctuation">:</span>
            <span class="keyword">if</span> current<span class="punctuation">.</span>parent<span class="punctuation">.</span>left <span class="operator">==</span> current<span class="punctuation">:</span>
                current<span class="punctuation">.</span>parent<span class="punctuation">.</span>left <span class="operator">=</span> <span class="boolean">null</span>
            <span class="keyword">else</span><span class="punctuation">:</span>
                current<span class="punctuation">.</span>parent<span class="punctuation">.</span>right <span class="operator">=</span> <span class="boolean">null</span>
            start_balance_from <span class="operator">=</span> current<span class="punctuation">.</span>parent
        <span class="keyword">else</span><span class="punctuation">:</span>
            root <span class="operator">=</span> <span class="boolean">null</span>  <span class="comment"># удаляем единственный узел</span>

        <span class="keyword">free</span> current

    <span class="keyword">else</span> <span class="keyword">if</span> current<span class="punctuation">.</span>left <span class="operator">==</span> <span class="boolean">null</span><span class="punctuation">:</span>  <span class="comment"># есть только правый ребёнок</span>
        <span class="keyword">if</span> current<span class="punctuation">.</span>parent <span class="keyword">is</span> <span class="keyword">not</span> <span class="boolean">null</span><span class="punctuation">:</span>
            <span class="keyword">if</span> current<span class="punctuation">.</span>parent<span class="punctuation">.</span>left <span class="operator">==</span> current<span class="punctuation">:</span>
                current<span class="punctuation">.</span>parent<span class="punctuation">.</span>left <span class="operator">=</span> current<span class="punctuation">.</span>right
            <span class="keyword">else</span><span class="punctuation">:</span>
                current<span class="punctuation">.</span>parent<span class="punctuation">.</span>right <span class="operator">=</span> current<span class="punctuation">.</span>right
            current<span class="punctuation">.</span>right<span class="punctuation">.</span>parent <span class="operator">=</span> current<span class="punctuation">.</span>parent
            start_balance_from <span class="operator">=</span> current<span class="punctuation">.</span>parent
        <span class="keyword">else</span><span class="punctuation">:</span>
            root <span class="operator">=</span> current<span class="punctuation">.</span>right
            root<span class="punctuation">.</span>parent <span class="operator">=</span> <span class="boolean">null</span>

        <span class="keyword">free</span> current

    <span class="keyword">else</span> <span class="keyword">if</span> current<span class="punctuation">.</span>right <span class="operator">==</span> <span class="boolean">null</span><span class="punctuation">:</span>  <span class="comment"># есть только левый ребёнок</span>
        <span class="keyword">if</span> current<span class="punctuation">.</span>parent <span class="keyword">is</span> <span class="keyword">not</span> <span class="boolean">null</span><span class="punctuation">:</span>
            <span class="keyword">if</span> current<span class="punctuation">.</span>parent<span class="punctuation">.</span>left <span class="operator">==</span> current<span class="punctuation">:</span>
                current<span class="punctuation">.</span>parent<span class="punctuation">.</span>left <span class="operator">=</span> current<span class="punctuation">.</span>left
            <span class="keyword">else</span><span class="punctuation">:</span>
                current<span class="punctuation">.</span>parent<span class="punctuation">.</span>right <span class="operator">=</span> current<span class="punctuation">.</span>left
            current<span class="punctuation">.</span>left<span class="punctuation">.</span>parent <span class="operator">=</span> current<span class="punctuation">.</span>parent
            start_balance_from <span class="operator">=</span> current<span class="punctuation">.</span>parent
        <span class="keyword">else</span><span class="punctuation">:</span>
            root <span class="operator">=</span> current<span class="punctuation">.</span>left
            root<span class="punctuation">.</span>parent <span class="operator">=</span> <span class="boolean">null</span>
        <span class="keyword">free</span> current

    <span class="keyword">else</span><span class="punctuation">:</span>  <span class="comment"># оба ребёнка</span>
        successor <span class="operator">=</span> current<span class="punctuation">.</span>right
        <span class="keyword">while</span> successor<span class="punctuation">.</span>left <span class="keyword">is</span> <span class="keyword">not</span> <span class="boolean">null</span><span class="punctuation">:</span>
            successor <span class="operator">=</span> successor<span class="punctuation">.</span>left

        <span class="keyword">copy</span> <span class="keyword">from</span> successor <span class="keyword">to</span> current

        <span class="keyword">if</span> successor<span class="punctuation">.</span>parent<span class="punctuation">.</span>left <span class="operator">==</span> successor<span class="punctuation">:</span>
            successor<span class="punctuation">.</span>parent<span class="punctuation">.</span>left <span class="operator">=</span> successor<span class="punctuation">.</span>right
        <span class="keyword">else</span><span class="punctuation">:</span>
            successor<span class="punctuation">.</span>parent<span class="punctuation">.</span>right <span class="operator">=</span> successor<span class="punctuation">.</span>right

        <span class="keyword">if</span> successor<span class="punctuation">.</span>right <span class="keyword">is</span> <span class="keyword">not</span> <span class="boolean">null</span><span class="punctuation">:</span>
            successor<span class="punctuation">.</span>right<span class="punctuation">.</span>parent <span class="operator">=</span> successor<span class="punctuation">.</span>parent

        start_balance_from <span class="operator">=</span> successor<span class="punctuation">.</span>parent
        <span class="keyword">free</span> successor

    <span class="keyword">if</span> start_balance_from <span class="keyword">is</span> <span class="boolean">null</span><span class="punctuation">:</span>
        <span class="keyword">return</span>

    current <span class="operator">=</span> start_balance_from
    <span class="keyword">while</span> current <span class="keyword">is</span> <span class="keyword">not</span> <span class="boolean">null</span><span class="punctuation">:</span>
        parent <span class="operator">=</span> current<span class="punctuation">.</span>parent

        <span class="keyword">if</span> parent <span class="keyword">is</span> <span class="keyword">not</span> <span class="boolean">null</span><span class="punctuation">:</span>
            <span class="keyword">if</span> current <span class="operator">==</span> parent<span class="punctuation">.</span>left<span class="punctuation">:</span>
                parent<span class="punctuation">.</span>balance <span class="operator">-=</span> <span class="number">1</span>
            <span class="keyword">else</span><span class="punctuation">:</span>
                parent<span class="punctuation">.</span>balance <span class="operator">+=</span> <span class="number">1</span>

        <span class="keyword">if</span> current<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="number">1</span> <span class="keyword">or</span> current<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">:</span>  <span class="comment"># высота не изменилась</span>
            <span class="keyword">break</span>

        <span class="keyword">else</span> <span class="keyword">if</span> current<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="number">0</span><span class="punctuation">:</span>  <span class="comment"># продолжаем подъем</span>
            current <span class="operator">=</span> current<span class="punctuation">.</span>parent
            <span class="keyword">continue</span>

        <span class="keyword">else</span> <span class="keyword">if</span> current<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="number">2</span><span class="punctuation">:</span>  <span class="comment"># нарушен баланс влево</span>
            <span class="keyword">if</span> current<span class="punctuation">.</span>left<span class="punctuation">.</span>balance <span class="operator">&gt;=</span> <span class="number">0</span><span class="punctuation">:</span>
                new_root <span class="operator">=</span> <span class="function">rotate_right</span><span class="punctuation">(</span>current<span class="punctuation">)</span>
            <span class="keyword">else</span><span class="punctuation">:</span>
                new_root <span class="operator">=</span> <span class="function">big_rotate_right</span><span class="punctuation">(</span>current<span class="punctuation">)</span>

        <span class="keyword">else</span> <span class="keyword">if</span> current<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="operator">-</span><span class="number">2</span><span class="punctuation">:</span>  <span class="comment"># нарушен баланс вправо</span>
            <span class="keyword">if</span> current<span class="punctuation">.</span>right<span class="punctuation">.</span>balance <span class="operator">&lt;=</span> <span class="number">0</span><span class="punctuation">:</span>
                new_root <span class="operator">=</span> <span class="function">rotate_left</span><span class="punctuation">(</span>current<span class="punctuation">)</span>
            <span class="keyword">else</span><span class="punctuation">:</span>
                new_root <span class="operator">=</span> <span class="function">big_rotate_left</span><span class="punctuation">(</span>current<span class="punctuation">)</span>

        <span class="comment"># Обновляем ссылки у родителя нового корня</span>
        <span class="keyword">if</span> new_root<span class="punctuation">.</span>parent <span class="keyword">is</span> <span class="keyword">not</span> <span class="boolean">null</span><span class="punctuation">:</span>
            <span class="keyword">if</span> new_root<span class="punctuation">.</span>parent<span class="punctuation">.</span>left <span class="operator">==</span> current<span class="punctuation">:</span>
                new_root<span class="punctuation">.</span>parent<span class="punctuation">.</span>left <span class="operator">=</span> new_root
            <span class="keyword">else</span><span class="punctuation">:</span>
                new_root<span class="punctuation">.</span>parent<span class="punctuation">.</span>right <span class="operator">=</span> new_root
        <span class="keyword">else</span><span class="punctuation">:</span>
            root <span class="operator">=</span> new_root

        <span class="comment"># Решаем, продолжать ли подъем</span>
        <span class="keyword">if</span> new_root<span class="punctuation">.</span>balance <span class="operator">==</span> <span class="number">0</span><span class="punctuation">:</span>
            current <span class="operator">=</span> new_root<span class="punctuation">.</span>parent
        <span class="keyword">else</span><span class="punctuation">:</span>
            <span class="keyword">break</span><!----></code><!----></div></div><!----> <h1 class="svelte-mdj34r"><!---->Разбалансировка деревьев<!----></h1><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Пусть <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">bf</mi><mo>⁡</mo><mi>v</mi><mi mathvariant="normal">∣</mi><mo>⩽</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">|\bf v| \le b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm" style="margin-right:0.07778em;">bf</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span><!----></span><!--]--><!----> для всех узлов дерева.
    Давайте получим оценку высоты дерева.<!----></p><!----> <p class="svelte-xyzgp3"><!---->Пусть <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!----> — минимальное количество узлов в дереве высоты <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span></span></span></span><!----></span><!--]--><!---->.
    Из определения следует, что <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">N(0) = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span><!----></span><!--]--><!----> (пустое дерево) и <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">N(1) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!----> (только один узел).<!----></p><!----> <p class="svelte-xyzgp3"><!---->Для этого дерева выполнено условие баланса: <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">bf</mi><mo>⁡</mo><mi>v</mi><mi mathvariant="normal">∣</mi><mo>⩽</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">|\bf v| \le b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mord mathrm" style="margin-right:0.07778em;">bf</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span><!----></span><!--]--><!----> для всех узлов дерева.
    Тогда для дерева высоты <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span></span></span></span><!----></span><!--]--><!----> можно взять корень и разбить его на два поддерева.
    При этом для корня будет выполнено условие баланса. Значит,<!----></p><!----> <!--[--><div class="math-display svelte-16qk674"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>+</mo><mi>N</mi><mo stretchy="false">(</mo><mi>h</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>N</mi><mo stretchy="false">(</mo><mi>h</mi><mo>−</mo><mn>1</mn><mo>−</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(h) = 1 + N(h-1) + N(h-1-b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></span><!----></div><!--]--><!----> <p class="svelte-xyzgp3"><!---->Решение уравнения этого экспоненциальное.
    Давайте найдем точную оценку для <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!---->, и, как следствие, для высоты <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span></span></span></span><!----></span><!--]--><!---->.<!----></p><!----><!----></div><!----> <div class="proof svelte-17zasab"><div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Запишем сразу производящую функцию для <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!---->, учитывая, что <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>⩾</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">h \ge 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8311em;vertical-align:-0.1367em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⩾</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span><!----></span><!--]--><!---->.<!----></p><!----> <!--[--><div class="math-display svelte-16qk674"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>h</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant="normal">∞</mi></munderover><mi>N</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>⋅</mo><msup><mi>x</mi><mi>h</mi></msup></mrow><annotation encoding="application/x-tex">G(x) = \sum\limits_{h=0}^\oo N(h) \cdot x^h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9535em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8991em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span><!----></div><!--]--><!----> <p class="svelte-xyzgp3"><!---->Подставим внутрь функции уравнение <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>+</mo><mi>N</mi><mo stretchy="false">(</mo><mi>h</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>N</mi><mo stretchy="false">(</mo><mi>h</mi><mo>−</mo><mn>1</mn><mo>−</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(h) = 1 + N(h-1) + N(h-1-b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!----><!----></p><!----> <!--[--><div class="math-display svelte-16qk674"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>h</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant="normal">∞</mi></munderover><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><mn>1</mn><mo>+</mo><mi>N</mi><mo stretchy="false">(</mo><mi>h</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>N</mi><mo stretchy="false">(</mo><mi>h</mi><mo>−</mo><mn>1</mn><mo>−</mo><mi>b</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo><mo>⋅</mo><msup><mi>x</mi><mi>h</mi></msup><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>x</mi></mrow></mfrac><mo>+</mo><mi>x</mi><mo>⋅</mo><mi>G</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>x</mi><mrow><mi>b</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>⋅</mo><mi>G</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(x) = \sum\limits_{h=0}^\oo \big(1 + N(h-1) + N(h-1-b) \big) \cdot x^h = \frac{1}{1-x} + x \cdot G(x) + x^{b+1} \cdot G(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9535em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mord"><span class="delimsizing size1">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8991em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8991em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span><!----></div><!--]--><!----> <p class="svelte-xyzgp3"><!---->Мы получили производящую функцию<!----></p><!----> <!--[--><div class="math-display svelte-16qk674"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⋅</mo><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><mn>1</mn><mo>−</mo><mi>x</mi><mo>−</mo><msup><mi>x</mi><mrow><mi>b</mi><mo>+</mo><mn>1</mn></mrow></msup><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">G(x) = \frac{1}{(1-x) \cdot \big( 1 - x - x^{b+1} \big)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4114em;vertical-align:-1.09em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.26em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7751em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size1">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.09em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><!----></div><!--]--><!----> <p class="svelte-xyzgp3"><!---->Пусть полюсы функции <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!----> — точка <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!----> и <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">b+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span><!----></span><!--]--><!----> точка <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\rho_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><!----></span><!--]--><!---->,
    при этом точки <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\rho_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><!----></span><!--]--><!----> являются решением уравнения <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>x</mi><mo>−</mo><msup><mi>x</mi><mrow><mi>b</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">1-x-x^{b+1} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span><!----></span><!--]--><!---->.
    Тогда <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!----> можно разложить в сумму простых дробей<!----></p><!----> <!--[--><div class="math-display svelte-16qk674"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>x</mi></mrow></mfrac><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>b</mi></munderover><mfrac><mn>1</mn><mrow><mo stretchy="false">(</mo><msub><mi>ρ</mi><mi>k</mi></msub><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mi>b</mi><msub><mi>ρ</mi><mi>k</mi></msub><mo>−</mo><mi>b</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mfrac><mo>⋅</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>x</mi><mi mathvariant="normal">/</mi><msub><mi>ρ</mi><mi>k</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">G(x) = - \frac{1}{1-x} + \sum\limits_{k=0}^b \frac{1}{(\rho_k - 1) \cdot (b \rho_k - b - 1)} \cdot \frac{1}{1-x/\rho_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.1382em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.2574em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span><span class="mord">/</span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><!----></div><!--]--><!----><!----></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Для удобства можно ввести другие переменные <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>φ</mi><mi>k</mi></msub><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><msub><mi>ρ</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\varphi_k = 1/\rho_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><!----></span><!--]--><!---->,
    которые являются корнями уравнения <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>φ</mi><mi>k</mi><mrow><mi>b</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>−</mo><msubsup><mi>φ</mi><mi>k</mi><mi>b</mi></msubsup><mo>−</mo><mn>1</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\varphi_k^{b+1} - \varphi_k^b - 1 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1905em;vertical-align:-0.3013em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8892em;"><span style="top:-2.3987em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1322em;vertical-align:-0.2831em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span><!----></span><!--]--><!---->.
    Тогда формула для <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!----> преобразуется в<!----></p><!----> <!--[--><div class="math-display svelte-16qk674"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>x</mi></mrow></mfrac><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>b</mi></munderover><mfrac><msubsup><mi>φ</mi><mi>k</mi><mn>2</mn></msubsup><mrow><mo stretchy="false">(</mo><msub><mi>φ</mi><mi>k</mi></msub><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mi>b</mi><msub><mi>φ</mi><mi>k</mi></msub><mo>−</mo><mi>b</mi><mo>+</mo><msub><mi>φ</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>⋅</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><msub><mi>φ</mi><mi>k</mi></msub><mo>⋅</mo><mi>x</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">G(x) = - \frac{1}{1-x} + \sum\limits_{k=0}^b \frac{\varphi_k^2}{(\varphi_k - 1) \cdot (b \varphi_k - b + \varphi_k)} \cdot \frac{1}{1 - \varphi_k \cdot x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.1382em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.2019em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><!----></div><!--]--><!----><!----></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Коэффициент <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!----> при <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mi>h</mi></msup></mrow><annotation encoding="application/x-tex">x^h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span><!----></span><!--]--><!----> в производящей функции <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!----> вычисляются по теореме о представлении коэффициента рациональной производящей функции<!----></p><!----> <!--[--><div class="math-display svelte-16qk674"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mn>1</mn><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>b</mi></munderover><mfrac><msubsup><mi>φ</mi><mi>k</mi><mrow><mi>h</mi><mo>+</mo><mn>2</mn></mrow></msubsup><mrow><mo stretchy="false">(</mo><msub><mi>φ</mi><mi>k</mi></msub><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mi>b</mi><msub><mi>φ</mi><mi>k</mi></msub><mo>−</mo><mi>b</mi><mo>+</mo><msub><mi>φ</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">N(h) = -1 + \sum\limits_{k=0}^b \frac{\varphi_k^{h+2}}{(\varphi_k - 1) \cdot (b \varphi_k - b + \varphi_k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.1382em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5805em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6913em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8892em;"><span style="top:-2.3987em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><!----></div><!--]--><!----> <p class="svelte-xyzgp3"><!---->Можно вывести отсюда грубоватую асимптотическую оценку <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span><!----></span><!--]--><!---->.
    Обозначим за <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>φ</mi></mrow><annotation encoding="application/x-tex">\varphi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">φ</span></span></span></span><!----></span><!--]--><!----> единственный действительный положительный корень.
    У него же будет максимальный модуль, а значит он вносит наибольший вклад в асимптотику.<!----></p><!----> <!--[--><div class="math-display svelte-16qk674"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><msup><mi>φ</mi><mn>2</mn></msup><mrow><mo stretchy="false">(</mo><mi>φ</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mi>b</mi><mi>φ</mi><mo>−</mo><mi>b</mi><mo>+</mo><mi>φ</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>⋅</mo><msup><mi>φ</mi><mi>h</mi></msup><mo>−</mo><mn>1</mn><mo>+</mo><mi>O</mi><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><msup><mi>φ</mi><mrow><mo>−</mo><mi>h</mi></mrow></msup><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo></mrow><annotation encoding="application/x-tex">N(h) = \frac{\varphi^2}{(\varphi - 1) \cdot (b \varphi - b + \varphi)} \cdot \varphi^h - 1 + O \big( \varphi^{-h} \big)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4271em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">φ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mord mathnormal">φ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">φ</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0935em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2491em;vertical-align:-0.35em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size1">)</span></span></span></span></span></span><!----></div><!--]--><!----><!----></div><!----><!----></div><!----> <div class="par svelte-q2zea3"><p class="svelte-xyzgp3"><!---->Теперь, зная <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">N(h) = n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span><!----></span><!--]--><!---->, мы можем получить оценку высоты сбалансированного дерева<!----></p><!----> <!--[--><div class="math-display svelte-16qk674"><!----><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>h</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mi>log</mi><mo>⁡</mo><mi>φ</mi></mrow></mfrac><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo>−</mo><mfrac><mn>1</mn><mrow><mi>log</mi><mo>⁡</mo><mi>φ</mi></mrow></mfrac><mo>⋅</mo><mrow><mo fence="true">(</mo><mfrac><msup><mi>φ</mi><mn>2</mn></msup><mrow><mo stretchy="false">(</mo><mi>φ</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><mi>b</mi><mi>φ</mi><mo>−</mo><mi>b</mi><mo>+</mo><mi>φ</mi><mo stretchy="false">)</mo></mrow></mfrac><mo fence="true">)</mo></mrow><mo>+</mo><mfrac><mn>1</mn><mrow><mi>n</mi><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mi>φ</mi></mrow></mfrac><mo>+</mo><mi>O</mi><mrow><mo fence="true">(</mo><mfrac><mn>1</mn><msup><mi>n</mi><mn>2</mn></msup></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">h = \frac{1}{\log \varphi} \cdot \log n - \frac{1}{\log \varphi} \cdot
          \left( \frac{\varphi^2}{(\varphi - 1) \cdot (b \varphi - b + \varphi)} \right)
                  + \frac{1}{n \cdot \log \varphi} + O \left( \frac{1}{n^2} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2019em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">φ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.2019em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">φ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4411em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">φ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mord mathnormal">φ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">φ</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.2019em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">φ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span><!----></div><!--]--><!----> <p class="svelte-xyzgp3"><!---->Какие выводы можно сделать?
    Если сильно нагрубить, можно сказать, что <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mi>O</mi><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo></mrow><annotation encoding="application/x-tex">h = O \big( \log n \big)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mord"><span class="delimsizing size1">)</span></span></span></span></span><!----></span><!--]--><!---->,
    что было ясно еще при первом взгляде на рекурсивную формулу.
    А ещё, константы довольно маленькие, то есть мы можем позволить себе много свободы
    (в смысле взять довольно большое значение <!--[!--><span class="math"><!----><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span><!----></span><!--]--><!----> без существенной просадки по высоте).<!----></p><!----><!----></div><!----> <h1 class="svelte-mdj34r"><!---->Слабые AVL деревья<!----></h1><!----><!----><!----></article> <div class="svelte-1cvbhgs"></div><!----><!--]--><!----></main><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_1h7j5ru = {
						base: new URL("../..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../../_app/immutable/entry/start.Dkklk6Rf.js"),
						import("../../_app/immutable/entry/app.Bva7xl9u.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2, 118],
							data: [null,null,null],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
</body>
</html>
